!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("opensheetmusicdisplay")):"function"==typeof define&&define.amd?define(["opensheetmusicdisplay"],e):"object"==typeof exports?exports.osme=e(require("opensheetmusicdisplay")):t.osme=e(t.opensheetmusicdisplay)}(window,(function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e){(function(){t.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},function(e,n){e.exports=t},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.prototype.hasOwnProperty;function i(t){return"function"==typeof t}function s(t){return void 0===t}function o(t){return"[object String]"===Object.prototype.toString.call(t)}e.has=function(t,e){return r.call(t,e)},e.defaultCompare=function(t,e){return t<e?-1:t===e?0:1},e.defaultEquals=function(t,e){return t===e},e.defaultToString=function(t){return null===t?"COLLECTION_NULL":s(t)?"COLLECTION_UNDEFINED":o(t)?"$s"+t:"$o"+t.toString()},e.makeString=function(t,n){if(void 0===n&&(n=","),null===t)return"COLLECTION_NULL";if(s(t))return"COLLECTION_UNDEFINED";if(o(t))return t.toString();var r="{",i=!0;for(var a in t)e.has(t,a)&&(i?i=!1:r+=n,r=r+a+":"+t[a]);return r+"}"},e.isFunction=i,e.isUndefined=s,e.isString=o,e.reverseCompareFunction=function(t){return s(t)||!i(t)?function(t,e){return t<e?1:t===e?0:-1}:function(e,n){return-1*t(e,n)}},e.compareToEquals=function(t){return function(e,n){return 0===t(e,n)}}},function(t,e,n){(function(){var e,r,i,s,o,a,u,h,l,c,d,p,f,m,y,g,w={}.hasOwnProperty,v=[].splice;({isObject:g,isFunction:y,isEmpty:m,getValue:f}=n(4)),h=null,i=null,s=null,o=null,a=null,d=null,p=null,c=null,u=null,r=null,l=null,e=null,t.exports=function(){class t{constructor(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,h||(h=n(11),i=n(13),s=n(14),o=n(15),a=n(16),d=n(21),p=n(22),c=n(23),u=n(41),r=n(0),l=n(62),n(12),e=n(63))}setParent(t){var e,n,r,i,s;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),s=[],n=0,r=(i=this.children).length;n<r;n++)e=i[n],s.push(e.setParent(this));return s}element(t,e,n){var r,i,s,o,a,u,h,l,c;if(u=null,null===e&&null==n&&([e,n]=[{},null]),null==e&&(e={}),e=f(e),g(e)||([n,e]=[e,n]),null!=t&&(t=f(t)),Array.isArray(t))for(s=0,h=t.length;s<h;s++)i=t[s],u=this.element(i);else if(y(t))u=this.element(t.apply());else if(g(t)){for(a in t)if(w.call(t,a))if(c=t[a],y(c)&&(c=c.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))u=this.attribute(a.substr(this.stringify.convertAttKey.length),c);else if(!this.options.separateArrayItems&&Array.isArray(c)&&m(c))u=this.dummy();else if(g(c)&&m(c))u=this.element(a);else if(this.options.keepNullNodes||null!=c)if(!this.options.separateArrayItems&&Array.isArray(c))for(o=0,l=c.length;o<l;o++)i=c[o],(r={})[a]=i,u=this.element(r);else g(c)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?u=this.element(c):(u=this.element(a)).element(c):u=this.element(a,c);else u=this.dummy()}else u=this.options.keepNullNodes||null!==n?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(n):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(n):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(n):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(n):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),n):this.node(t,e,n):this.dummy();if(null==u)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return u}insertBefore(t,e,n){var r,i,s,o,a;if(null!=t?t.type:void 0)return o=e,(s=t).setParent(this),o?(i=children.indexOf(o),a=children.splice(i),children.push(s),Array.prototype.push.apply(children,a)):children.push(s),s;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return i=this.parent.children.indexOf(this),a=this.parent.children.splice(i),r=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,a),r}insertAfter(t,e,n){var r,i,s;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return i=this.parent.children.indexOf(this),s=this.parent.children.splice(i+1),r=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,s),r}remove(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),v.apply(this.parent.children,[t,t-t+1].concat([])),this.parent}node(t,e,n){var r;return null!=t&&(t=f(t)),e||(e={}),e=f(e),g(e)||([n,e]=[e,n]),r=new h(this,t,e),null!=n&&r.text(n),this.children.push(r),r}text(t){var e;return g(t)&&this.element(t),e=new p(this,t),this.children.push(e),this}cdata(t){var e;return e=new i(this,t),this.children.push(e),this}comment(t){var e;return e=new s(this,t),this.children.push(e),this}commentBefore(t){var e,n;return e=this.parent.children.indexOf(this),n=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,n),this}commentAfter(t){var e,n;return e=this.parent.children.indexOf(this),n=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,n),this}raw(t){var e;return e=new d(this,t),this.children.push(e),this}dummy(){return new u(this)}instruction(t,e){var n,r,i,s,o;if(null!=t&&(t=f(t)),null!=e&&(e=f(e)),Array.isArray(t))for(s=0,o=t.length;s<o;s++)n=t[s],this.instruction(n);else if(g(t))for(n in t)w.call(t,n)&&(r=t[n],this.instruction(n,r));else y(e)&&(e=e.apply()),i=new c(this,t,e),this.children.push(i);return this}instructionBefore(t,e){var n,r;return n=this.parent.children.indexOf(this),r=this.parent.children.splice(n),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,r),this}instructionAfter(t,e){var n,r;return n=this.parent.children.indexOf(this),r=this.parent.children.splice(n+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,r),this}declaration(t,e,n){var i,s;return i=this.document(),s=new o(i,t,e,n),0===i.children.length?i.children.unshift(s):i.children[0].type===r.Declaration?i.children[0]=s:i.children.unshift(s),i.root()||i}dtd(t,e){var n,i,s,o,u,h,l,c,d;for(n=this.document(),i=new a(n,t,e),s=o=0,h=(c=n.children).length;o<h;s=++o)if(c[s].type===r.DocType)return n.children[s]=i,i;for(s=u=0,l=(d=n.children).length;u<l;s=++u)if(d[s].isRoot)return n.children.splice(s,0,i),i;return n.children.push(i),i}up(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent}root(){var t;for(t=this;t;){if(t.type===r.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}}document(){var t;for(t=this;t;){if(t.type===r.Document)return t;t=t.parent}}end(t){return this.document().end(t)}prev(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]}next(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]}importDocument(t){var e,n,i,s,o;if((n=t.root().clone()).parent=this,n.isRoot=!1,this.children.push(n),this.type===r.Document&&(n.isRoot=!0,n.documentObject=this,this.rootObject=n,this.children))for(i=0,s=(o=this.children).length;i<s;i++)if((e=o[i]).type===r.DocType){e.name=n.name;break}return this}debugInfo(t){var e,n;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(n=this.parent)?n.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""}ele(t,e,n){return this.element(t,e,n)}nod(t,e,n){return this.node(t,e,n)}txt(t){return this.text(t)}dat(t){return this.cdata(t)}com(t){return this.comment(t)}ins(t,e){return this.instruction(t,e)}doc(){return this.document()}dec(t,e,n){return this.declaration(t,e,n)}e(t,e,n){return this.element(t,e,n)}n(t,e,n){return this.node(t,e,n)}t(t){return this.text(t)}d(t){return this.cdata(t)}c(t){return this.comment(t)}r(t){return this.raw(t)}i(t,e){return this.instruction(t,e)}u(){return this.up()}importXMLBuilder(t){return this.importDocument(t)}attribute(t,e){throw new Error("attribute() applies to element nodes only.")}att(t,e){return this.attribute(t,e)}a(t,e){return this.attribute(t,e)}removeAttribute(t){throw new Error("attribute() applies to element nodes only.")}replaceChild(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeChild(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendChild(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasChildNodes(){return 0!==this.children.length}cloneNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalize(){throw new Error("This DOM method is not implemented."+this.debugInfo())}isSupported(t,e){return!0}hasAttributes(){return 0!==this.attribs.length}compareDocumentPosition(t){var n;return this,this===t?0:this.document()!==t.document()?(n=e.Disconnected|e.ImplementationSpecific,Math.random()<.5?n|=e.Preceding:n|=e.Following,n):this.isAncestor(t)?e.Contains|e.Preceding:this.isDescendant(t)?e.Contains|e.Following:this.isPreceding(t)?e.Preceding:e.Following}isSameNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupPrefix(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}isDefaultNamespace(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupNamespaceURI(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(t){var e,n,r;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=n=0,r=this.children.length-1;0<=r?n<=r:n>=r;e=0<=r?++n:--n)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0}getFeature(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setUserData(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}getUserData(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}contains(t){return!!t&&(t===this||this.isDescendant(t))}isDescendant(t){var e,n,r,i;for(n=0,r=(i=this.children).length;n<r;n++){if(t===(e=i[n]))return!0;if(e.isDescendant(t))return!0}return!1}isAncestor(t){return t.isDescendant(this)}isPreceding(t){var e,n;return e=this.treePosition(t),n=this.treePosition(this),-1!==e&&-1!==n&&e<n}isFollowing(t){var e,n;return e=this.treePosition(t),n=this.treePosition(this),-1!==e&&-1!==n&&e>n}treePosition(t){var e,n;return n=0,e=!1,this.foreachTreeNode(this.document(),(function(r){if(n++,!e&&r===t)return e=!0})),e?n:-1}foreachTreeNode(t,e){var n,r,i,s,o;for(t||(t=this.document()),r=0,i=(s=t.children).length;r<i;r++){if(o=e(n=s[r]))return o;if(o=this.foreachTreeNode(n,e))return o}}}return Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new l(this.children)),this.childNodeList}}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(t.prototype,"textContent",{get:function(){var t,e,n,i,s;if(this.nodeType===r.Element||this.nodeType===r.DocumentFragment){for(s="",e=0,n=(i=this.children).length;e<n;e++)(t=i[e]).textContent&&(s+=t.textContent);return s}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t}.call(this)}).call(this)},function(t,e){(function(){var e,n,r,i,s,o,a,u={}.hasOwnProperty;e=function(t,...e){var n,r,i,o;if(s(Object.assign))Object.assign.apply(null,arguments);else for(n=0,i=e.length;n<i;n++)if(null!=(o=e[n]))for(r in o)u.call(o,r)&&(t[r]=o[r]);return t},s=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},o=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},r=function(t){return s(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},i=function(t){var e;if(r(t))return!t.length;for(e in t)if(u.call(t,e))return!1;return!0},a=function(t){var e,n;return o(t)&&(n=Object.getPrototypeOf(t))&&(e=n.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},n=function(t){return s(t.valueOf)?t.valueOf():t},t.exports.assign=e,t.exports.isFunction=s,t.exports.isObject=o,t.exports.isArray=r,t.exports.isEmpty=i,t.exports.isPlainObject=a,t.exports.getValue=n}).call(this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=function(){function t(t){this.table={},this.nElements=0,this.toStr=t||r.defaultToString}return t.prototype.getValue=function(t){var e=this.table["$"+this.toStr(t)];if(!r.isUndefined(e))return e.value},t.prototype.setValue=function(t,e){if(!r.isUndefined(t)&&!r.isUndefined(e)){var n,i="$"+this.toStr(t),s=this.table[i];return r.isUndefined(s)?(this.nElements++,n=void 0):n=s.value,this.table[i]={key:t,value:e},n}},t.prototype.remove=function(t){var e="$"+this.toStr(t),n=this.table[e];if(!r.isUndefined(n))return delete this.table[e],this.nElements--,n.value},t.prototype.keys=function(){var t=[];for(var e in this.table)if(r.has(this.table,e)){var n=this.table[e];t.push(n.key)}return t},t.prototype.values=function(){var t=[];for(var e in this.table)if(r.has(this.table,e)){var n=this.table[e];t.push(n.value)}return t},t.prototype.forEach=function(t){for(var e in this.table)if(r.has(this.table,e)){var n=this.table[e];if(!1===t(n.key,n.value))return}},t.prototype.containsKey=function(t){return!r.isUndefined(this.getValue(t))},t.prototype.clear=function(){this.table={},this.nElements=0},t.prototype.size=function(){return this.nElements},t.prototype.isEmpty=function(){return this.nElements<=0},t.prototype.toString=function(){var t="{";return this.forEach((function(e,n){t+="\n\t"+e+" : "+n})),t+"\n}"},t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(66))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2);function i(t,e,n){for(var i=n||r.defaultEquals,s=t.length,o=0;o<s;o++)if(i(t[o],e))return o;return-1}e.indexOf=i,e.lastIndexOf=function(t,e,n){for(var i=n||r.defaultEquals,s=t.length-1;s>=0;s--)if(i(t[s],e))return s;return-1},e.contains=function(t,e,n){return i(t,e,n)>=0},e.remove=function(t,e,n){var r=i(t,e,n);return!(r<0)&&(t.splice(r,1),!0)},e.frequency=function(t,e,n){for(var i=n||r.defaultEquals,s=t.length,o=0,a=0;a<s;a++)i(t[a],e)&&o++;return o},e.equals=function(t,e,n){var i=n||r.defaultEquals;if(t.length!==e.length)return!1;for(var s=t.length,o=0;o<s;o++)if(!i(t[o],e[o]))return!1;return!0},e.copy=function(t){return t.concat()},e.swap=function(t,e,n){if(e<0||e>=t.length||n<0||n>=t.length)return!1;var r=t[e];return t[e]=t[n],t[n]=r,!0},e.toString=function(t){return"["+t.toString()+"]"},e.forEach=function(t,e){for(var n=0,r=t;n<r.length;n++){if(!1===e(r[n]))return}}},function(t,e,n){(function(){var e;e=n(3),t.exports=function(){class t extends e{constructor(t){super(t),this.value=""}clone(){return Object.create(this)}substringData(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendData(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}insertData(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}deleteData(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceData(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(t){return!!super.isEqualNode(t)&&t.data===this.data}}return Object.defineProperty(t.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),t}.call(this)}).call(this)},function(t,e){(function(){t.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(7),s=function(){function t(){this.firstNode=null,this.lastNode=null,this.nElements=0}return t.prototype.add=function(t,e){if(r.isUndefined(e)&&(e=this.nElements),e<0||e>this.nElements||r.isUndefined(t))return!1;var n=this.createNode(t);if(0===this.nElements||null===this.lastNode)this.firstNode=n,this.lastNode=n;else if(e===this.nElements)this.lastNode.next=n,this.lastNode=n;else if(0===e)n.next=this.firstNode,this.firstNode=n;else{var i=this.nodeAtIndex(e-1);if(null===i)return!1;n.next=i.next,i.next=n}return this.nElements++,!0},t.prototype.first=function(){if(null!==this.firstNode)return this.firstNode.element},t.prototype.last=function(){if(null!==this.lastNode)return this.lastNode.element},t.prototype.elementAtIndex=function(t){var e=this.nodeAtIndex(t);if(null!==e)return e.element},t.prototype.indexOf=function(t,e){var n=e||r.defaultEquals;if(r.isUndefined(t))return-1;for(var i=this.firstNode,s=0;null!==i;){if(n(i.element,t))return s;s++,i=i.next}return-1},t.prototype.contains=function(t,e){return this.indexOf(t,e)>=0},t.prototype.remove=function(t,e){var n=e||r.defaultEquals;if(this.nElements<1||r.isUndefined(t))return!1;for(var i=null,s=this.firstNode;null!==s;){if(n(s.element,t))return null===i?(this.firstNode=s.next,s===this.lastNode&&(this.lastNode=null)):s===this.lastNode?(this.lastNode=i,i.next=s.next,s.next=null):(i.next=s.next,s.next=null),this.nElements--,!0;i=s,s=s.next}return!1},t.prototype.clear=function(){this.firstNode=null,this.lastNode=null,this.nElements=0},t.prototype.equals=function(e,n){var i=n||r.defaultEquals;return e instanceof t&&(this.size()===e.size()&&this.equalsAux(this.firstNode,e.firstNode,i))},t.prototype.equalsAux=function(t,e,n){for(;null!==t&&null!==e;){if(!n(t.element,e.element))return!1;t=t.next,e=e.next}return!0},t.prototype.removeElementAtIndex=function(t){if(!(t<0||t>=this.nElements||null===this.firstNode||null===this.lastNode)){var e;if(1===this.nElements)e=this.firstNode.element,this.firstNode=null,this.lastNode=null;else{var n=this.nodeAtIndex(t-1);null===n?(e=this.firstNode.element,this.firstNode=this.firstNode.next):n.next===this.lastNode&&(e=this.lastNode.element,this.lastNode=n),null!==n&&null!==n.next&&(e=n.next.element,n.next=n.next.next)}return this.nElements--,e}},t.prototype.forEach=function(t){for(var e=this.firstNode;null!==e&&!1!==t(e.element);)e=e.next},t.prototype.reverse=function(){for(var t=null,e=this.firstNode,n=null;null!==e;)n=e.next,e.next=t,t=e,e=n;n=this.firstNode,this.firstNode=this.lastNode,this.lastNode=n},t.prototype.toArray=function(){for(var t=[],e=this.firstNode;null!==e;)t.push(e.element),e=e.next;return t},t.prototype.size=function(){return this.nElements},t.prototype.isEmpty=function(){return this.nElements<=0},t.prototype.toString=function(){return i.toString(this.toArray())},t.prototype.nodeAtIndex=function(t){if(t<0||t>=this.nElements)return null;if(t===this.nElements-1)return this.lastNode;for(var e=this.firstNode,n=0;n<t&&null!==e;n++)e=e.next;return e},t.prototype.createNode=function(t){return{element:t,next:null}},t}();e.default=s},function(t,e,n){(function(){var e,r,i,s,o,a,u,h={}.hasOwnProperty;({isObject:u,isFunction:a,getValue:o}=n(4)),s=n(3),e=n(0),r=n(40),i=n(12),t.exports=function(){class t extends s{constructor(t,n,r){var i,s,o,a;if(super(t),null==n)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(n),this.type=e.Element,this.attribs={},this.schemaTypeInfo=null,null!=r&&this.attribute(r),t.type===e.Document&&(this.isRoot=!0,this.documentObject=t,t.rootObject=this,t.children))for(s=0,o=(a=t.children).length;s<o;s++)if((i=a[s]).type===e.DocType){i.name=this.name;break}}clone(){var t,e,n,r;for(e in(n=Object.create(this)).isRoot&&(n.documentObject=null),n.attribs={},r=this.attribs)h.call(r,e)&&(t=r[e],n.attribs[e]=t.clone());return n.children=[],this.children.forEach((function(t){var e;return(e=t.clone()).parent=n,n.children.push(e)})),n}attribute(t,e){var n,i;if(null!=t&&(t=o(t)),u(t))for(n in t)h.call(t,n)&&(i=t[n],this.attribute(n,i));else a(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.attribs[t]=new r(this,t,""):null!=e&&(this.attribs[t]=new r(this,t,e));return this}removeAttribute(t){var e,n,r;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=o(t),Array.isArray(t))for(n=0,r=t.length;n<r;n++)e=t[n],delete this.attribs[e];else delete this.attribs[t];return this}toString(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))}att(t,e){return this.attribute(t,e)}a(t,e){return this.attribute(t,e)}getAttribute(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null}setAttribute(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNode(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null}setAttributeNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNS(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNodeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNodeNS(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasAttribute(t){return this.attribs.hasOwnProperty(t)}hasAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttribute(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e}setIdAttributeNS(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttributeNode(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(t){var e,n,r;if(!super.isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=n=0,r=this.attribs.length-1;0<=r?n<=r:n>=r;e=0<=r?++n:--n)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0}}return Object.defineProperty(t.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new i(this.attribs)),this.attributeMap}}),t}.call(this)}).call(this)},function(t,e){(function(){t.exports=function(){class t{constructor(t){this.nodes=t}clone(){return this.nodes=null}getNamedItem(t){return this.nodes[t]}setNamedItem(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null}removeNamedItem(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null}item(t){return this.nodes[Object.keys(this.nodes)[t]]||null}getNamedItemNS(t,e){throw new Error("This DOM method is not implemented.")}setNamedItemNS(t){throw new Error("This DOM method is not implemented.")}removeNamedItemNS(t,e){throw new Error("This DOM method is not implemented.")}}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t}.call(this)}).call(this)},function(t,e,n){(function(){var e,r;e=n(0),r=n(8),t.exports=class extends r{constructor(t,n){if(super(t),null==n)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=e.CData,this.value=this.stringify.cdata(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))}}}).call(this)},function(t,e,n){(function(){var e,r;e=n(0),r=n(8),t.exports=class extends r{constructor(t,n){if(super(t),null==n)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=e.Comment,this.value=this.stringify.comment(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))}}}).call(this)},function(t,e,n){(function(){var e,r,i;({isObject:i}=n(4)),r=n(3),e=n(0),t.exports=class extends r{constructor(t,n,r,s){super(t),i(n)&&({version:n,encoding:r,standalone:s}=n),n||(n="1.0"),this.type=e.Declaration,this.version=this.stringify.xmlVersion(n),null!=r&&(this.encoding=this.stringify.xmlEncoding(r)),null!=s&&(this.standalone=this.stringify.xmlStandalone(s))}toString(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))}}}).call(this)},function(t,e,n){(function(){var e,r,i,s,o,a,u,h;({isObject:h}=n(4)),u=n(3),e=n(0),r=n(17),s=n(18),i=n(19),o=n(20),a=n(12),t.exports=function(){class t extends u{constructor(t,n,r){var i,s,o,a;if(super(t),this.type=e.DocType,t.children)for(s=0,o=(a=t.children).length;s<o;s++)if((i=a[s]).type===e.Element){this.name=i.name;break}this.documentObject=t,h(n)&&({pubID:n,sysID:r}=n),null==r&&([r,n]=[n,r]),null!=n&&(this.pubID=this.stringify.dtdPubID(n)),null!=r&&(this.sysID=this.stringify.dtdSysID(r))}element(t,e){var n;return n=new i(this,t,e),this.children.push(n),this}attList(t,e,n,i,s){var o;return o=new r(this,t,e,n,i,s),this.children.push(o),this}entity(t,e){var n;return n=new s(this,!1,t,e),this.children.push(n),this}pEntity(t,e){var n;return n=new s(this,!0,t,e),this.children.push(n),this}notation(t,e){var n;return n=new o(this,t,e),this.children.push(n),this}toString(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))}ele(t,e){return this.element(t,e)}att(t,e,n,r,i){return this.attList(t,e,n,r,i)}ent(t,e){return this.entity(t,e)}pent(t,e){return this.pEntity(t,e)}not(t,e){return this.notation(t,e)}up(){return this.root()||this.documentObject}isEqualNode(t){return!!super.isEqualNode(t)&&(t.name===this.name&&(t.publicId===this.publicId&&t.systemId===this.systemId))}}return Object.defineProperty(t.prototype,"entities",{get:function(){var t,n,r,i,s;for(i={},n=0,r=(s=this.children).length;n<r;n++)(t=s[n]).type!==e.EntityDeclaration||t.pe||(i[t.name]=t);return new a(i)}}),Object.defineProperty(t.prototype,"notations",{get:function(){var t,n,r,i,s;for(i={},n=0,r=(s=this.children).length;n<r;n++)(t=s[n]).type===e.NotationDeclaration&&(i[t.name]=t);return new a(i)}}),Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(t.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t}.call(this)}).call(this)},function(t,e,n){(function(){var e,r;r=n(3),e=n(0),t.exports=class extends r{constructor(t,n,r,i,s,o){if(super(t),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==r)throw new Error("Missing DTD attribute name. "+this.debugInfo(n));if(!i)throw new Error("Missing DTD attribute type. "+this.debugInfo(n));if(!s)throw new Error("Missing DTD attribute default. "+this.debugInfo(n));if(0!==s.indexOf("#")&&(s="#"+s),!s.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(n));if(o&&!s.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(n));this.elementName=this.stringify.name(n),this.type=e.AttributeDeclaration,this.attributeName=this.stringify.name(r),this.attributeType=this.stringify.dtdAttType(i),o&&(this.defaultValue=this.stringify.dtdAttDefault(o)),this.defaultValueType=s}toString(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))}}}).call(this)},function(t,e,n){(function(){var e,r,i;({isObject:i}=n(4)),r=n(3),e=n(0),t.exports=function(){class t extends r{constructor(t,n,r,s){if(super(t),null==r)throw new Error("Missing DTD entity name. "+this.debugInfo(r));if(null==s)throw new Error("Missing DTD entity value. "+this.debugInfo(r));if(this.pe=!!n,this.name=this.stringify.name(r),this.type=e.EntityDeclaration,i(s)){if(!s.pubID&&!s.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(r));if(s.pubID&&!s.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(r));if(this.internal=!1,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID)),null!=s.nData&&(this.nData=this.stringify.dtdNData(s.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(r))}else this.value=this.stringify.dtdEntityValue(s),this.internal=!0}toString(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))}}return Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(t.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(t.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(t.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(t.prototype,"xmlVersion",{get:function(){return null}}),t}.call(this)}).call(this)},function(t,e,n){(function(){var e,r;r=n(3),e=n(0),t.exports=class extends r{constructor(t,n,r){if(super(t),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());r||(r="(#PCDATA)"),Array.isArray(r)&&(r="("+r.join(",")+")"),this.name=this.stringify.name(n),this.type=e.ElementDeclaration,this.value=this.stringify.dtdElementValue(r)}toString(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))}}}).call(this)},function(t,e,n){(function(){var e,r;r=n(3),e=n(0),t.exports=function(){class t extends r{constructor(t,n,r){if(super(t),null==n)throw new Error("Missing DTD notation name. "+this.debugInfo(n));if(!r.pubID&&!r.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(n));this.name=this.stringify.name(n),this.type=e.NotationDeclaration,null!=r.pubID&&(this.pubID=this.stringify.dtdPubID(r.pubID)),null!=r.sysID&&(this.sysID=this.stringify.dtdSysID(r.sysID))}toString(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))}}return Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),t}.call(this)}).call(this)},function(t,e,n){(function(){var e,r;e=n(0),r=n(3),t.exports=class extends r{constructor(t,n){if(super(t),null==n)throw new Error("Missing raw text. "+this.debugInfo());this.type=e.Raw,this.value=this.stringify.raw(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))}}}).call(this)},function(t,e,n){(function(){var e,r;e=n(0),r=n(8),t.exports=function(){class t extends r{constructor(t,n){if(super(t),null==n)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=e.Text,this.value=this.stringify.text(n)}clone(){return Object.create(this)}toString(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))}splitText(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceWholeText(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}return Object.defineProperty(t.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"wholeText",{get:function(){var t,e,n;for(n="",e=this.previousSibling;e;)n=e.data+n,e=e.previousSibling;for(n+=this.data,t=this.nextSibling;t;)n+=t.data,t=t.nextSibling;return n}}),t}.call(this)}).call(this)},function(t,e,n){(function(){var e,r;e=n(0),r=n(8),t.exports=class extends r{constructor(t,n,r){if(super(t),null==n)throw new Error("Missing instruction target. "+this.debugInfo());this.type=e.ProcessingInstruction,this.target=this.stringify.insTarget(n),this.name=this.target,r&&(this.value=this.stringify.insValue(r))}clone(){return Object.create(this)}toString(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))}isEqualNode(t){return!!super.isEqualNode(t)&&t.target===this.target}}}).call(this)},function(t,e,n){(function(){var e;e=n(43),t.exports=class extends e{constructor(t){super(t)}document(t,e){var n,r,i,s,o;for(e=this.filterOptions(e),s="",r=0,i=(o=t.children).length;r<i;r++)n=o[r],s+=this.writeChildNode(n,e,0);return e.pretty&&s.slice(-e.newline.length)===e.newline&&(s=s.slice(0,-e.newline.length)),s}}}).call(this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(26),i=n(1),s=n(1),o=n(1),a=n(57),u=n(1);class h extends r.SourceGeneratorPlugin{constructor(t){super(t)}getPluginName(){return h.NAME}generate(){this.measureDuration=new s.Fraction(this.options.time_signature.Rhythm.Numerator,this.options.time_signature.Rhythm.Denominator),this.beat=new s.Fraction(1,this.options.time_signature.Rhythm.Denominator);const t=this.createMusicSheet(),e=this.configureInstruments(t),n=this.options.measure_count,r=this.createInstrumentStaff(e,t),i=this.createInstrumentVoice(e);super.createState(i);const o=this.options.scale_key;for(let e=0;e<n;e++){const n=this.createSourceMeasure(new s.Fraction(this.measureDuration.Numerator*e,this.measureDuration.Denominator),s.Fraction.createFromFraction(this.measureDuration));0===e&&this.setClefAndKeyInstruction(n,this.options.scale_key),n.MeasureNumber=e+1,t.addMeasure(n);const a={scaleKey:o};this.generateNotes(n,r,i,a)}return t.SourceMeasures.last().endingBarStyleEnum=u.SystemLinesEnum.ThinBold,t.fillStaffList(),t}generateNotes(t,e,n,r){const i=[];super.setLocalState(n,[]);const o=new s.Fraction(0,4);for(;o.RealValue<t.Duration.RealValue;){const a=o.clone(),u=this.getNextEntry(t,r.scaleKey,a),h=u.Pitch,l=u.Duration;let c=void 0;if(o.RealValue+l.RealValue<=t.Duration.RealValue)c=this.generateEntry(t,e,n,a,l,h),o.Add(l);else{const r=s.Fraction.minus(t.Duration,o);r.Numerator>1||(c=this.generateEntry(t,e,n,a,r,h),o.Add(r))}void 0!==c&&(super.adaptLocalState(n,c),i.push(c))}return super.updateGlobalState(n,i),i}getNextEntry(t,e,n){const r=this.options.pitch_settings.rollAndDraw(),i=new a.MusicalEntry,s=this.chooseScaleTone(e,r);if(i.Pitch=s.toPitch(1),i.Duration=this.chooseDuration(t,n),void 0===i.Pitch)throw new Error("entry.pitch is undefined");return i}calcWeightsForDurations(t,e,n){const r=new Array(n.length),i=new s.Fraction(e.Numerator,2*e.Denominator);for(let o=0;o<n.length;o++){const a=n[o].Object;let u=1;let h=s.Fraction.plus(t,a);for(;!h.lte(e);)h.Sub(e);h.lte(i)||(h=s.Fraction.minus(e,h));const l=h.RealValue/i.RealValue;l>1e-5&&(u=l*l*.5),r[o]=u}return r}chooseDuration(t,e){let n;const r=e.isOnBeat(t.ActiveTimeSignature);let i=!1;do{const o=this.calcWeightsForDurations(e,this.beat,this.options.duration_settings.getValues());n=this.options.duration_settings.rollAndDraw(o),i=new s.Fraction(1,4).lte(n)&&!r;const a=Math.abs(e.distanceFromBeat(t.ActiveTimeSignature)-new s.Fraction(1,8).RealValue)<h.FloatInaccuracyTolerance;i=i&&!a}while(i);return s.Fraction.createFromFraction(n)}chooseScaleTone(t,e){const n=e%t.getTones().length;return t.getTones()[n]}generateEntry(t,e,n,r,s,o){const a=t.findOrCreateStaffEntry(r,0,e).staffEntry,u=t.findOrCreateVoiceEntry(a,n).voiceEntry,h=new i.Note(u,a,s,o);return u.Notes.push(h),h}setClefAndKeyInstruction(t,e,n=new o.ClefInstruction){const r=new i.SourceStaffEntry(void 0,void 0),s=e.getKeyNumber(),a=e.getKeyMode(),u=new o.KeyInstruction(void 0,s,a);return n.Parent=r,r.Instructions.push(n),r.Instructions.push(u),r.Instructions.push(this.options.time_signature),t.FirstInstructionsStaffEntries[0]=r,t}createSourceMeasure(t,e){const n=new i.SourceMeasure(1,this.options.rules);return n.AbsoluteTimestamp=t,n.Duration=e,n.ActiveTimeSignature=this.options.time_signature.Rhythm,n.MeasureNumber=1,n}createInstrumentVoice(t){const e=new i.Voice(t,1);return t.Voices.push(e),e}createInstrumentStaff(t,e){const n=new i.Staff(t,1);return e.Staves.push(n),t.Staves.push(n),n}configureInstruments(t){const e=new i.InstrumentalGroup("group",t,void 0),n=new i.Instrument(1,"Part 1",t,e);return t.InstrumentalGroups.push(e),t.Instruments.push(n),n.Visible=!0,n}createMusicSheet(){return new i.MusicSheet}}h.NAME="example_source_generator",h.FloatInaccuracyTolerance=1e-4,e.ExampleSourceGenerator=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(27),i=n(1),s=n(1),o=n(28),a=n(34);e.SourceGeneratorPlugin=class{constructor(t){this.historyMap=new o.Dictionary,this.options=t}getPluginType(){return r.OSMPluginType.SOURCE_GENERATOR}setOptions(t){this.options=t}generateGraphicalMusicSheet(t){const e=new s.VexFlowMusicSheetCalculator(t.Rules),n=new i.GraphicalMusicSheet(t,e);return e.initialize(n),n}debugStatistics(){for(const t of this.historyMap.keys()){this.historyMap.getValue(t).printStatistics()}}createState(t){const e=new a.StateManager;return this.historyMap.setValue(t,e),e}getVoiceState(t){return this.historyMap.getValue(t)}updateGlobalState(t,e){this.historyMap.getValue(t).updateGlobaleState(e)}setLocalState(t,e){this.historyMap.getValue(t).setLocalState(e)}adaptLocalState(t,e){this.historyMap.getValue(t).adaptLocalState(e)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.SOURCE_GENERATOR=0]="SOURCE_GENERATOR",t[t.DISPLAY_OUTPUT=1]="DISPLAY_OUTPUT"}(e.OSMPluginType||(e.OSMPluginType={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(7);e.arrays=r;var i=n(47);e.Bag=i.default;var s=n(48);e.BSTree=s.default;var o=n(30);e.BSTreeKV=o.default;var a=n(5);e.Dictionary=a.default;var u=n(32);e.Heap=u.default;var h=n(49);e.LinkedDictionary=h.default;var l=n(10);e.LinkedList=l.default;var c=n(50);e.MultiDictionary=c.default;var d=n(33);e.FactoryDictionary=d.default;var p=n(33);e.DefaultDictionary=p.default;var f=n(31);e.Queue=f.default;var m=n(51);e.PriorityQueue=m.default;var y=n(29);e.Set=y.default;var g=n(52);e.Stack=g.default;var w=n(53);e.MultiRootTree=w.default;var v=n(2);e.util=v},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(7),s=n(5),o=function(){function t(t){this.dictionary=new s.default(t)}return t.prototype.contains=function(t){return this.dictionary.containsKey(t)},t.prototype.add=function(t){return!this.contains(t)&&!r.isUndefined(t)&&(this.dictionary.setValue(t,t),!0)},t.prototype.intersection=function(t){var e=this;this.forEach((function(n){return t.contains(n)||e.remove(n),!0}))},t.prototype.union=function(t){var e=this;t.forEach((function(t){return e.add(t),!0}))},t.prototype.difference=function(t){var e=this;t.forEach((function(t){return e.remove(t),!0}))},t.prototype.isSubsetOf=function(t){if(this.size()>t.size())return!1;var e=!0;return this.forEach((function(n){return!!t.contains(n)||(e=!1,!1)})),e},t.prototype.remove=function(t){return!!this.contains(t)&&(this.dictionary.remove(t),!0)},t.prototype.forEach=function(t){this.dictionary.forEach((function(e,n){return t(n)}))},t.prototype.toArray=function(){return this.dictionary.values()},t.prototype.isEmpty=function(){return this.dictionary.isEmpty()},t.prototype.size=function(){return this.dictionary.size()},t.prototype.clear=function(){this.dictionary.clear()},t.prototype.toString=function(){return i.toString(this.toArray())},t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(31),s=function(){function t(t){this.root=null,this.compare=t||r.defaultCompare,this.nElements=0}return t.prototype.add=function(t){return!r.isUndefined(t)&&(null!==this.insertNode(this.createNode(t))&&(this.nElements++,!0))},t.prototype.clear=function(){this.root=null,this.nElements=0},t.prototype.isEmpty=function(){return 0===this.nElements},t.prototype.size=function(){return this.nElements},t.prototype.contains=function(t){return!r.isUndefined(t)&&null!==this.searchNode(this.root,t)},t.prototype.search=function(t){var e=this.searchNode(this.root,t);if(null!==e)return e.element},t.prototype.remove=function(t){var e=this.searchNode(this.root,t);return null!==e&&(this.removeNode(e),this.nElements--,!0)},t.prototype.inorderTraversal=function(t){this.inorderTraversalAux(this.root,t,{stop:!1})},t.prototype.preorderTraversal=function(t){this.preorderTraversalAux(this.root,t,{stop:!1})},t.prototype.postorderTraversal=function(t){this.postorderTraversalAux(this.root,t,{stop:!1})},t.prototype.levelTraversal=function(t){this.levelTraversalAux(this.root,t)},t.prototype.minimum=function(){if(!this.isEmpty()&&null!==this.root)return this.minimumAux(this.root).element},t.prototype.maximum=function(){if(!this.isEmpty()&&null!==this.root)return this.maximumAux(this.root).element},t.prototype.forEach=function(t){this.inorderTraversal(t)},t.prototype.toArray=function(){var t=[];return this.inorderTraversal((function(e){return t.push(e),!0})),t},t.prototype.height=function(){return this.heightAux(this.root)},t.prototype.searchNode=function(t,e){for(var n=1;null!==t&&0!==n;)(n=this.compare(e,t.element))<0?t=t.leftCh:n>0&&(t=t.rightCh);return t},t.prototype.transplant=function(t,e){null===t.parent?this.root=e:t===t.parent.leftCh?t.parent.leftCh=e:t.parent.rightCh=e,null!==e&&(e.parent=t.parent)},t.prototype.removeNode=function(t){if(null===t.leftCh)this.transplant(t,t.rightCh);else if(null===t.rightCh)this.transplant(t,t.leftCh);else{var e=this.minimumAux(t.rightCh);e.parent!==t&&(this.transplant(e,e.rightCh),e.rightCh=t.rightCh,e.rightCh.parent=e),this.transplant(t,e),e.leftCh=t.leftCh,e.leftCh.parent=e}},t.prototype.inorderTraversalAux=function(t,e,n){null===t||n.stop||(this.inorderTraversalAux(t.leftCh,e,n),n.stop||(n.stop=!1===e(t.element),n.stop||this.inorderTraversalAux(t.rightCh,e,n)))},t.prototype.levelTraversalAux=function(t,e){var n=new i.default;for(null!==t&&n.enqueue(t),t=n.dequeue()||null;null!=t;){if(!1===e(t.element))return;null!==t.leftCh&&n.enqueue(t.leftCh),null!==t.rightCh&&n.enqueue(t.rightCh),t=n.dequeue()||null}},t.prototype.preorderTraversalAux=function(t,e,n){null===t||n.stop||(n.stop=!1===e(t.element),n.stop||(this.preorderTraversalAux(t.leftCh,e,n),n.stop||this.preorderTraversalAux(t.rightCh,e,n)))},t.prototype.postorderTraversalAux=function(t,e,n){null===t||n.stop||(this.postorderTraversalAux(t.leftCh,e,n),n.stop||(this.postorderTraversalAux(t.rightCh,e,n),n.stop||(n.stop=!1===e(t.element))))},t.prototype.minimumAux=function(t){for(;null!=t&&null!==t.leftCh;)t=t.leftCh;return t},t.prototype.maximumAux=function(t){for(;null!=t&&null!==t.rightCh;)t=t.rightCh;return t},t.prototype.heightAux=function(t){return null===t?-1:Math.max(this.heightAux(t.leftCh),this.heightAux(t.rightCh))+1},t.prototype.insertNode=function(t){for(var e=null,n=this.root;null!==n;){var r=this.compare(t.element,n.element);if(0===r)return null;r<0?(e=n,n=n.leftCh):(e=n,n=n.rightCh)}return t.parent=e,null===e?this.root=t:this.compare(t.element,e.element)<0?e.leftCh=t:e.rightCh=t,t},t.prototype.createNode=function(t){return{element:t,leftCh:null,rightCh:null,parent:null}},t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(10),i=function(){function t(){this.list=new r.default}return t.prototype.enqueue=function(t){return this.list.add(t)},t.prototype.add=function(t){return this.list.add(t)},t.prototype.dequeue=function(){if(0!==this.list.size()){var t=this.list.first();return this.list.removeElementAtIndex(0),t}},t.prototype.peek=function(){if(0!==this.list.size())return this.list.first()},t.prototype.size=function(){return this.list.size()},t.prototype.contains=function(t,e){return this.list.contains(t,e)},t.prototype.isEmpty=function(){return this.list.size()<=0},t.prototype.clear=function(){this.list.clear()},t.prototype.forEach=function(t){this.list.forEach(t)},t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(7),s=function(){function t(t){this.data=[],this.compare=t||r.defaultCompare}return t.prototype.leftChildIndex=function(t){return 2*t+1},t.prototype.rightChildIndex=function(t){return 2*t+2},t.prototype.parentIndex=function(t){return Math.floor((t-1)/2)},t.prototype.minIndex=function(t,e){return e>=this.data.length?t>=this.data.length?-1:t:this.compare(this.data[t],this.data[e])<=0?t:e},t.prototype.siftUp=function(t){for(var e=this.parentIndex(t);t>0&&this.compare(this.data[e],this.data[t])>0;)i.swap(this.data,e,t),t=e,e=this.parentIndex(t)},t.prototype.siftDown=function(t){for(var e=this.minIndex(this.leftChildIndex(t),this.rightChildIndex(t));e>=0&&this.compare(this.data[t],this.data[e])>0;)i.swap(this.data,e,t),t=e,e=this.minIndex(this.leftChildIndex(t),this.rightChildIndex(t))},t.prototype.peek=function(){return this.data.length>0?this.data[0]:void 0},t.prototype.add=function(t){return!r.isUndefined(t)&&(this.data.push(t),this.siftUp(this.data.length-1),!0)},t.prototype.removeRoot=function(){if(this.data.length>0){var t=this.data[0];return this.data[0]=this.data[this.data.length-1],this.data.splice(this.data.length-1,1),this.data.length>0&&this.siftDown(0),t}},t.prototype.contains=function(t){var e=r.compareToEquals(this.compare);return i.contains(this.data,t,e)},t.prototype.size=function(){return this.data.length},t.prototype.isEmpty=function(){return this.data.length<=0},t.prototype.clear=function(){this.data.length=0},t.prototype.forEach=function(t){i.forEach(this.data,t)},t}();e.default=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(5),o=n(2),a=function(t){function e(e,n){var r=t.call(this,n)||this;return r.defaultFactoryFunction=e,r}return i(e,t),e.prototype.setDefault=function(e,n){var r=t.prototype.getValue.call(this,e);return o.isUndefined(r)?(this.setValue(e,n),n):r},e.prototype.getValue=function(t){return this.setDefault(t,this.defaultFactoryFunction())},e}(s.default);e.default=a},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(54)),r(n(26)),r(n(25)),r(n(55)),r(n(56))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Distribution=class{constructor(t,e){this.entries=e,this.complexity=t}getComplexity(){return this.complexity}static EQUIVALENT_VALUES(t,e){const n=new Array(e),r=1*t/(1*e);console.log("Distribution: "+t+" "+e+" "+r);for(let t=0;t<e;t++)n[t]=r,console.log("Distribution: values[i] "+n[t]+" "+n);return n}calculateWeightSum(t){let e=0;if(void 0!==t)for(let n=0;n<this.entries.length;n++)e+=this.entries[n].Weight*t[n];else for(let t=0;t<this.entries.length;t++)e+=this.entries[t].Weight;return e}getValues(){return this.entries}rollAndDraw(t){const e=this.calculateWeightSum(t);let n=Math.random()*e,r=0;for(;n>0;){r=Math.floor(Math.random()*this.entries.length);let e=this.entries[r].Weight;void 0!==t&&(e*=t[r]),n-=e}return this.entries[r].Object}};e.DistributionEntry=class{constructor(t,e){this.object=t,this.weight=e}get Object(){return this.object}get Weight(){return this.weight}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(1),s=n(1);e.XMLPropertyTransformer=class{pitchToAlterStep(t){return void 0===t||void 0===t.Pitch||void 0===t.Pitch.Accidental?0:i.Pitch.HalfTonesFromAccidental(t.Pitch.Accidental)}pitchToAlterString(t){if(void 0!==t&&void 0!==t.Pitch&&void 0!==t.Pitch.Accidental)switch(t.Pitch.Accidental){case s.AccidentalEnum.SHARP:return"sharp";case s.AccidentalEnum.FLAT:return"flat";case s.AccidentalEnum.NATURAL:return"natural";case s.AccidentalEnum.NONE:default:return}}measureToNumber(t){return t.MeasureNumber}measureToDivisions(t){return 32}clefToClefLine(t){if(void 0!==t.Line)return t.Line;switch(t.ClefPitch.FundamentalNote){case s.NoteEnum.G:return 2;case s.NoteEnum.F:return 4;case s.NoteEnum.C:return 3;default:return 2}}clefToClefSign(t){return i.Pitch.getNoteEnumString(t.ClefPitch.FundamentalNote)}getClefInstruction(t){if(this.guardInstructions(t))return;const e=t.FirstInstructionsStaffEntries[0].Instructions.filter(t=>t instanceof r.ClefInstruction);return e.length>0&&e[0]instanceof r.ClefInstruction?e[0]:void 0}getKeyInstruction(t){if(this.guardInstructions(t))return;const e=t.FirstInstructionsStaffEntries[0].Instructions.filter(t=>t instanceof r.KeyInstruction);return e.length>0&&e[0]instanceof r.KeyInstruction?e[0]:void 0}guardInstructions(t){return t.FirstInstructionsStaffEntries.length<1||void 0===t.FirstInstructionsStaffEntries[0]}keyToFifths(t){return t.Key.valueOf()}getKeyType(t){return Math.sign(t.Key.valueOf())}keyToMode(t){switch(t.Mode){case r.KeyEnum.major:return"major";case r.KeyEnum.minor:return"minor";default:return"major"}}noteToNoteString(t){return i.Pitch.getNoteEnumString(t.Pitch.FundamentalNote)}noteToOctaveNumber(t){return t.Pitch.Octave.valueOf()+3}noteToDurationNumber(t){const e=t.Length.Numerator*(128/t.Length.Denominator);return 0===e?128:e}noteToDurationType(t){switch(t.Length.RealValue){case 1/128:return"128th";case 1/64:return"64th";case 1/32:return"32nd";case 1/16:return"16th";case 1/8:return"eighth";case.25:return"quarter";case.5:return"half";case 1:return"whole";default:return"WRONG"}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(58);e.XMLDriver=class{constructor(t){this.root=void 0,this.transformer=t}begin(t,e){this.root=r.create("score-partwise",{version:"1.0",encoding:"UTF-8",standalone:!1,pubID:"-//Recordare//DTD MusicXML 3.0 Partwise//EN",sysID:"http://www.musicxml.org/dtds/partwise.dtd"}),this.root.attribute("version","3.0");this.root.element("work").element("work-title",e);const n=this.root.element("identification");n.element("creator",t).attribute("type","composer");const i=n.element("encoding");i.element("encoder","Open Sheet Music Education"),i.element("software","Open Sheet Music Education - XMLExport"),i.element("encoding-description","MusicXML 3.0 generic notation with Open Sheet Music Education"),this.partList=this.root.element("part-list")}beginPart(t){const e=this.partList.element("score-part");e.attribute("id",t),e.element("part-name","Music"),this.currentPart=this.root.element("part"),this.currentPart.att("id",t)}endPart(){this.currentPart.end(),this.currentPart=void 0}endMeasure(){this.currentMeasure.end(),this.currentMeasure=void 0}beginMeasure(t,e=!1,n=!1,r=!1){const i=this.transformer.measureToNumber(t),s=this.transformer.measureToDivisions(t),o=this.transformer.getClefInstruction(t),a=void 0===o?void 0:this.transformer.clefToClefSign(o),u=void 0===o?void 0:this.transformer.clefToClefLine(o),h=this.transformer.getKeyInstruction(t),l=void 0===h?void 0:this.transformer.keyToFifths(h),c=void 0===h?void 0:this.transformer.keyToMode(h),d=t.ActiveTimeSignature.Numerator,p=t.ActiveTimeSignature.Denominator;this.currentMeasure=this.currentPart.element("measure"),this.currentMeasure.att("number",i);const f=this.currentMeasure.element("attributes");f.element("divisions",s),r&&f.element({key:{fifths:{"#text":l},mode:{"#text":c}}}),n&&f.element({time:{beats:{"#text":d},"beat-type":{"#text":p}}}),e&&f.element({clef:{sign:{"#text":a},line:{"#text":u}}})}writeNote(t,e=0){const n=this.transformer.noteToNoteString(t),r=this.transformer.noteToOctaveNumber(t),i=this.transformer.noteToDurationNumber(t),s=this.transformer.noteToDurationType(t),o=this.transformer.pitchToAlterStep(t),a=this.transformer.pitchToAlterString(t),u=this.currentMeasure.element("note"),h=u.element("pitch");h.element("step",n),0!==o&&h.element("alter",o),h.element("octave",r),u.element("duration",i),u.element("type",s),0!==e?e!==o&&void 0!==a&&u.element("accidental",a):void 0!==a&&u.element("accidental",a)}endAndReturn(){return this.root.end({pretty:!0})}}},function(t,e){(function(){t.exports=class{hasFeature(t,e){return!0}createDocumentType(t,e,n){throw new Error("This DOM method is not implemented.")}createDocument(t,e,n){throw new Error("This DOM method is not implemented.")}createHTMLDocument(t){throw new Error("This DOM method is not implemented.")}getFeature(t,e){throw new Error("This DOM method is not implemented.")}}}).call(this)},function(t,e,n){(function(){var e,r,i,s,o,a,u;({isPlainObject:u}=n(4)),i=n(38),r=n(59),s=n(3),e=n(0),a=n(42),o=n(24),t.exports=function(){class t extends s{constructor(t){super(null),this.name="#document",this.type=e.Document,this.documentURI=null,this.domConfig=new r,t||(t={}),t.writer||(t.writer=new o),this.options=t,this.stringify=new a(t)}end(t){var e;return e={},t?u(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))}toString(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))}createElement(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createDocumentFragment(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTextNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createComment(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createCDATASection(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createProcessingInstruction(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttribute(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEntityReference(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}importNode(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createElementNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttributeNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementById(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}adoptNode(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalizeDocument(){throw new Error("This DOM method is not implemented."+this.debugInfo())}renameNode(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEvent(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}createRange(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createNodeIterator(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTreeWalker(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())}}return Object.defineProperty(t.prototype,"implementation",{value:new i}),Object.defineProperty(t.prototype,"doctype",{get:function(){var t,n,r,i;for(n=0,r=(i=this.children).length;n<r;n++)if((t=i[n]).type===e.DocType)return t;return null}}),Object.defineProperty(t.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(t.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(t.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(t.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].encoding:null}}),Object.defineProperty(t.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(t.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(t.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(t.prototype,"origin",{get:function(){return null}}),Object.defineProperty(t.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(t.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(t.prototype,"contentType",{get:function(){return null}}),t}.call(this)}).call(this)},function(t,e,n){(function(){var e;e=n(0),n(3),t.exports=function(){class t{constructor(t,n,r){if(this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==n)throw new Error("Missing attribute name. "+this.debugInfo(n));this.name=this.stringify.name(n),this.value=this.stringify.attValue(r),this.type=e.Attribute,this.isId=!1,this.schemaTypeInfo=null}clone(){return Object.create(this)}toString(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))}debugInfo(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"}isEqualNode(t){return t.namespaceURI===this.namespaceURI&&(t.prefix===this.prefix&&(t.localName===this.localName&&t.value===this.value))}}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"specified",{get:function(){return!0}}),t}.call(this)}).call(this)},function(t,e,n){(function(){var e,r;r=n(3),e=n(0),t.exports=class extends r{constructor(t){super(t),this.type=e.Dummy}clone(){return Object.create(this)}toString(t){return""}}}).call(this)},function(t,e){(function(){var e={}.hasOwnProperty;t.exports=function(){class t{constructor(t){var n,r,i;for(n in this.assertLegalChar=this.assertLegalChar.bind(this),this.assertLegalName=this.assertLegalName.bind(this),t||(t={}),this.options=t,this.options.version||(this.options.version="1.0"),r=t.stringify||{})e.call(r,n)&&(i=r[n],this[n]=i)}name(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")}text(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))}cdata(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))}comment(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)}raw(t){return this.options.noValidation?t:""+t||""}attValue(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))}insTarget(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}insValue(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)}xmlVersion(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t}xmlEncoding(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)}xmlStandalone(t){return this.options.noValidation?t:t?"yes":"no"}dtdPubID(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdSysID(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdElementValue(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdAttType(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdAttDefault(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdEntityValue(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}dtdNData(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")}assertLegalChar(t){var e,n;if(this.options.noValidation)return t;if(e="","1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,n=t.match(e))throw new Error(`Invalid character in string: ${t} at index ${n.index}`)}else if("1.1"===this.options.version&&(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,n=t.match(e)))throw new Error(`Invalid character in string: ${t} at index ${n.index}`);return t}assertLegalName(t){var e;if(this.options.noValidation)return t;if(this.assertLegalChar(t),e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!t.match(e))throw new Error("Invalid character in name");return t}textEscape(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))}attEscape(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))}}return t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t}.call(this)}).call(this)},function(t,e,n){(function(){var e,r,i,s={}.hasOwnProperty;({assign:i}=n(4)),e=n(0),n(15),n(16),n(13),n(14),n(11),n(21),n(22),n(23),n(41),n(17),n(19),n(18),n(20),r=n(9),t.exports=class{constructor(t){var e,n,r;for(e in t||(t={}),this.options=t,n=t.writer||{})s.call(n,e)&&(r=n[e],this["_"+e]=this[e],this[e]=r)}filterOptions(t){var e,n,s,o,a,u,h,l,c;return t||(t={}),t=i({},this.options,t),(e={writer:this}).pretty=t.pretty||!1,e.allowEmpty=t.allowEmpty||!1,e.indent=null!=(n=t.indent)?n:"  ",e.newline=null!=(s=t.newline)?s:"\n",e.offset=null!=(o=t.offset)?o:0,e.width=null!=(a=t.width)?a:0,e.dontPrettyTextNodes=null!=(u=null!=(h=t.dontPrettyTextNodes)?h:t.dontprettytextnodes)?u:0,e.spaceBeforeSlash=null!=(l=null!=(c=t.spaceBeforeSlash)?c:t.spacebeforeslash)?l:"",!0===e.spaceBeforeSlash&&(e.spaceBeforeSlash=" "),e.suppressPrettyCount=0,e.user={},e.state=r.None,e}indent(t,e,n){var r;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(r=(n||0)+e.offset+1)>0?new Array(r).join(e.indent):""}endline(t,e,n){return!e.pretty||e.suppressPrettyCount?"":e.newline}attribute(t,e,n){var r;return this.openAttribute(t,e,n),r=e.pretty&&e.width>0?t.name+'="'+t.value+'"':" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,n),r}cdata(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<![CDATA[",e.state=r.InsideTag,i+=t.value,e.state=r.CloseTag,i+="]]>"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}comment(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"\x3c!-- ",e.state=r.InsideTag,i+=t.value,e.state=r.CloseTag,i+=" --\x3e"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}declaration(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<?xml",e.state=r.InsideTag,i+=' version="'+t.version+'"',null!=t.encoding&&(i+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(i+=' standalone="'+t.standalone+'"'),e.state=r.CloseTag,i+=e.spaceBeforeSlash+"?>",i+=this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}docType(t,e,n){var i,s,o,a,u;if(n||(n=0),this.openNode(t,e,n),e.state=r.OpenTag,a=this.indent(t,e,n),a+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?a+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(a+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(a+=" [",a+=this.endline(t,e,n),e.state=r.InsideTag,s=0,o=(u=t.children).length;s<o;s++)i=u[s],a+=this.writeChildNode(i,e,n+1);e.state=r.CloseTag,a+="]"}return e.state=r.CloseTag,a+=e.spaceBeforeSlash+">",a+=this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),a}element(t,n,i){var o,a,u,h,l,c,d,p,f,m,y,g,w,v,E,b,I,D;if(i||(i=0),y=!1,this.openNode(t,n,i),n.state=r.OpenTag,g=this.indent(t,n,i)+"<"+t.name,n.pretty&&n.width>0)for(m in d=g.length,v=t.attribs)s.call(v,m)&&(o=v[m],d+(w=this.attribute(o,n,i)).length>n.width?(D=this.indent(t,n,i+1)+w,g+=this.endline(t,n,i)+D,d=D.length):(g+=D=" "+w,d+=D.length));else for(m in E=t.attribs)s.call(E,m)&&(o=E[m],g+=this.attribute(o,n,i));if(h=0===(u=t.children.length)?null:t.children[0],0===u||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))n.allowEmpty?(g+=">",n.state=r.CloseTag,g+="</"+t.name+">"+this.endline(t,n,i)):(n.state=r.CloseTag,g+=n.spaceBeforeSlash+"/>"+this.endline(t,n,i));else if(!n.pretty||1!==u||h.type!==e.Text&&h.type!==e.Raw||null==h.value){if(n.dontPrettyTextNodes)for(l=0,p=(b=t.children).length;l<p;l++)if(((a=b[l]).type===e.Text||a.type===e.Raw)&&null!=a.value){n.suppressPrettyCount++,y=!0;break}for(g+=">"+this.endline(t,n,i),n.state=r.InsideTag,c=0,f=(I=t.children).length;c<f;c++)a=I[c],g+=this.writeChildNode(a,n,i+1);n.state=r.CloseTag,g+=this.indent(t,n,i)+"</"+t.name+">",y&&n.suppressPrettyCount--,g+=this.endline(t,n,i),n.state=r.None}else g+=">",n.state=r.InsideTag,n.suppressPrettyCount++,y=!0,g+=this.writeChildNode(h,n,i+1),n.suppressPrettyCount--,y=!1,n.state=r.CloseTag,g+="</"+t.name+">"+this.endline(t,n,i);return this.closeNode(t,n,i),g}writeChildNode(t,n,r){switch(t.type){case e.CData:return this.cdata(t,n,r);case e.Comment:return this.comment(t,n,r);case e.Element:return this.element(t,n,r);case e.Raw:return this.raw(t,n,r);case e.Text:return this.text(t,n,r);case e.ProcessingInstruction:return this.processingInstruction(t,n,r);case e.Dummy:return"";case e.Declaration:return this.declaration(t,n,r);case e.DocType:return this.docType(t,n,r);case e.AttributeDeclaration:return this.dtdAttList(t,n,r);case e.ElementDeclaration:return this.dtdElement(t,n,r);case e.EntityDeclaration:return this.dtdEntity(t,n,r);case e.NotationDeclaration:return this.dtdNotation(t,n,r);default:throw new Error("Unknown XML node type: "+t.constructor.name)}}processingInstruction(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<?",e.state=r.InsideTag,i+=t.target,t.value&&(i+=" "+t.value),e.state=r.CloseTag,i+=e.spaceBeforeSlash+"?>",i+=this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}raw(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n),e.state=r.InsideTag,i+=t.value,e.state=r.CloseTag,i+=this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}text(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n),e.state=r.InsideTag,i+=t.value,e.state=r.CloseTag,i+=this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}dtdAttList(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<!ATTLIST",e.state=r.InsideTag,i+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(i+=" "+t.defaultValueType),t.defaultValue&&(i+=' "'+t.defaultValue+'"'),e.state=r.CloseTag,i+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}dtdElement(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<!ELEMENT",e.state=r.InsideTag,i+=" "+t.name+" "+t.value,e.state=r.CloseTag,i+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}dtdEntity(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<!ENTITY",e.state=r.InsideTag,t.pe&&(i+=" %"),i+=" "+t.name,t.value?i+=' "'+t.value+'"':(t.pubID&&t.sysID?i+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(i+=' SYSTEM "'+t.sysID+'"'),t.nData&&(i+=" NDATA "+t.nData)),e.state=r.CloseTag,i+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}dtdNotation(t,e,n){var i;return this.openNode(t,e,n),e.state=r.OpenTag,i=this.indent(t,e,n)+"<!NOTATION",e.state=r.InsideTag,i+=" "+t.name,t.pubID&&t.sysID?i+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?i+=' PUBLIC "'+t.pubID+'"':t.sysID&&(i+=' SYSTEM "'+t.sysID+'"'),e.state=r.CloseTag,i+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=r.None,this.closeNode(t,e,n),i}openNode(t,e,n){}closeNode(t,e,n){}openAttribute(t,e,n){}closeAttribute(t,e,n){}}}).call(this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.MAJOR=0]="MAJOR",t[t.MINOR_NATURAL=1]="MINOR_NATURAL",t[t.MINOR_HARMONIC=2]="MINOR_HARMONIC",t[t.MINOR_MELODIC=3]="MINOR_MELODIC"}(e.ScaleType||(e.ScaleType={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(36),i=n(37);e.XMLSourceExporter=class{constructor(){this.transformer=new r.XMLPropertyTransformer,this.xmlDriver=new i.XMLDriver(this.transformer)}export(t){const e=t.SourceMeasures;this.xmlDriver.begin(t.ComposerString,t.TitleString),this.xmlDriver.beginPart("P1");let n=!1,r=void 0;e.forEach(t=>{const e=t.VerticalSourceStaffEntryContainers,i=new Map,s=this.transformer.getKeyInstruction(t);if(void 0!==s&&(r=s),void 0!==r){const t=r.AlteratedNotes,e=this.transformer.getKeyType(r);t.forEach(t=>{i[t]=e})}n?this.xmlDriver.beginMeasure(t):(this.xmlDriver.beginMeasure(t,!0,!0,!0),n=!0),e.forEach(t=>{t.StaffEntries[0].VoiceEntries[0].Notes.forEach(t=>{const e=t.Pitch.FundamentalNote,n=i[e];this.xmlDriver.writeNote(t,n);const r=this.transformer.pitchToAlterStep(t);0!==r&&(i[e]=r)})}),this.xmlDriver.endMeasure()});return this.xmlDriver.endAndReturn()}}},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(35)),r(n(67)),r(n(68)),r(n(44))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(5),s=n(29),o=function(){function t(t){this.toStrF=t||r.defaultToString,this.dictionary=new i.default(this.toStrF),this.nElements=0}return t.prototype.add=function(t,e){if(void 0===e&&(e=1),r.isUndefined(t)||e<=0)return!1;if(this.contains(t))this.dictionary.getValue(t).copies+=e;else{var n={value:t,copies:e};this.dictionary.setValue(t,n)}return this.nElements+=e,!0},t.prototype.count=function(t){return this.contains(t)?this.dictionary.getValue(t).copies:0},t.prototype.contains=function(t){return this.dictionary.containsKey(t)},t.prototype.remove=function(t,e){if(void 0===e&&(e=1),r.isUndefined(t)||e<=0)return!1;if(this.contains(t)){var n=this.dictionary.getValue(t);return e>n.copies?this.nElements-=n.copies:this.nElements-=e,n.copies-=e,n.copies<=0&&this.dictionary.remove(t),!0}return!1},t.prototype.toArray=function(){for(var t=[],e=0,n=this.dictionary.values();e<n.length;e++)for(var r=n[e],i=r.value,s=r.copies,o=0;o<s;o++)t.push(i);return t},t.prototype.toSet=function(){for(var t=new s.default(this.toStrF),e=0,n=this.dictionary.values();e<n.length;e++){var r=n[e].value;t.add(r)}return t},t.prototype.forEach=function(t){this.dictionary.forEach((function(e,n){for(var r=n.value,i=n.copies,s=0;s<i;s++)if(!1===t(r))return!1;return!0}))},t.prototype.size=function(){return this.nElements},t.prototype.isEmpty=function(){return 0===this.nElements},t.prototype.clear=function(){this.nElements=0,this.dictionary.clear()},t}();e.default=o},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(n(30).default);e.default=s},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var s=n(5),o=n(2),a=function(){function t(t,e){this.key=t,this.value=e}return t.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},t}(),u=function(){function t(){this.key=null,this.value=null}return t.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},t}();var h=function(t){function e(e){var n=t.call(this,e)||this;return n.head=new u,n.tail=new u,n.head.next=n.tail,n.tail.prev=n.head,n}return i(e,t),e.prototype.appendToTail=function(t){var e=this.tail.prev;e.next=t,t.prev=e,t.next=this.tail,this.tail.prev=t},e.prototype.getLinkedDictionaryPair=function(t){if(!o.isUndefined(t)){var e="$"+this.toStr(t);return this.table[e]}},e.prototype.getValue=function(t){var e=this.getLinkedDictionaryPair(t);if(!o.isUndefined(e))return e.value},e.prototype.remove=function(e){var n=this.getLinkedDictionaryPair(e);if(!o.isUndefined(n))return t.prototype.remove.call(this,e),n.unlink(),n.value},e.prototype.clear=function(){t.prototype.clear.call(this),this.head.next=this.tail,this.tail.prev=this.head},e.prototype.replace=function(t,e){var n="$"+this.toStr(e.key);e.next=t.next,e.prev=t.prev,this.remove(t.key),e.prev.next=e,e.next.prev=e,this.table[n]=e,++this.nElements},e.prototype.setValue=function(t,e){if(!o.isUndefined(t)&&!o.isUndefined(e)){var n=this.getLinkedDictionaryPair(t),r=new a(t,e),i="$"+this.toStr(t);return o.isUndefined(n)?(this.appendToTail(r),this.table[i]=r,void++this.nElements):(this.replace(n,r),n.value)}},e.prototype.keys=function(){var t=[];return this.forEach((function(e,n){t.push(e)})),t},e.prototype.values=function(){var t=[];return this.forEach((function(e,n){t.push(n)})),t},e.prototype.forEach=function(t){for(var e=this.head.next;e.next;){if(!1===t(e.key,e.value))return;e=e.next}},e}(s.default);e.default=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(5),s=n(7),o=function(){function t(t,e,n){void 0===n&&(n=!1),this.dict=new i.default(t),this.equalsF=e||r.defaultEquals,this.allowDuplicate=n}return t.prototype.getValue=function(t){var e=this.dict.getValue(t);return r.isUndefined(e)?[]:s.copy(e)},t.prototype.setValue=function(t,e){if(r.isUndefined(t)||r.isUndefined(e))return!1;var n=this.dict.getValue(t);return r.isUndefined(n)?(this.dict.setValue(t,[e]),!0):!(!this.allowDuplicate&&s.contains(n,e,this.equalsF))&&(n.push(e),!0)},t.prototype.remove=function(t,e){if(r.isUndefined(e)){var n=this.dict.remove(t);return!r.isUndefined(n)}var i=this.dict.getValue(t);return!(r.isUndefined(i)||!s.remove(i,e,this.equalsF))&&(0===i.length&&this.dict.remove(t),!0)},t.prototype.keys=function(){return this.dict.keys()},t.prototype.values=function(){for(var t=[],e=0,n=this.dict.values();e<n.length;e++)for(var r=0,i=n[e];r<i.length;r++){var s=i[r];t.push(s)}return t},t.prototype.containsKey=function(t){return this.dict.containsKey(t)},t.prototype.clear=function(){this.dict.clear()},t.prototype.size=function(){return this.dict.size()},t.prototype.isEmpty=function(){return this.dict.isEmpty()},t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(32),s=function(){function t(t){this.heap=new i.default(r.reverseCompareFunction(t))}return t.prototype.enqueue=function(t){return this.heap.add(t)},t.prototype.add=function(t){return this.heap.add(t)},t.prototype.dequeue=function(){if(0!==this.heap.size()){var t=this.heap.peek();return this.heap.removeRoot(),t}},t.prototype.peek=function(){return this.heap.peek()},t.prototype.contains=function(t){return this.heap.contains(t)},t.prototype.isEmpty=function(){return this.heap.isEmpty()},t.prototype.size=function(){return this.heap.size()},t.prototype.clear=function(){this.heap.clear()},t.prototype.forEach=function(t){this.heap.forEach(t)},t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(10),i=function(){function t(){this.list=new r.default}return t.prototype.push=function(t){return this.list.add(t,0)},t.prototype.add=function(t){return this.list.add(t,0)},t.prototype.pop=function(){return this.list.removeElementAtIndex(0)},t.prototype.peek=function(){return this.list.first()},t.prototype.size=function(){return this.list.size()},t.prototype.contains=function(t,e){return this.list.contains(t,e)},t.prototype.isEmpty=function(){return this.list.isEmpty()},t.prototype.clear=function(){this.list.clear()},t.prototype.forEach=function(t){this.list.forEach(t)},t}();e.default=i},function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER",t[t.INSIDE_AT_END=2]="INSIDE_AT_END",t[t.INSIDE_AT_START=3]="INSIDE_AT_START"}(r||(r={}));var i=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.rootIds=t,this.nodes=e,this.initRootIds(),this.initNodes()}return t.prototype.initRootIds=function(){for(var t=0,e=this.rootIds;t<e.length;t++){var n=e[t];this.createEmptyNodeIfNotExist(n)}},t.prototype.initNodes=function(){for(var t in this.nodes)if(this.nodes.hasOwnProperty(t))for(var e=0,n=this.nodes[t];e<n.length;e++){var r=n[e];this.createEmptyNodeIfNotExist(r)}},t.prototype.createEmptyNodeIfNotExist=function(t){this.nodes[t]||(this.nodes[t]=[])},t.prototype.getRootIds=function(){return this.rootIds.slice()},t.prototype.getNodes=function(){var t={};for(var e in this.nodes)this.nodes.hasOwnProperty(e)&&(t[e]=this.nodes[e].slice());return t},t.prototype.getObject=function(){return{rootIds:this.getRootIds(),nodes:this.getNodes()}},t.prototype.toObject=function(){return this.getObject()},t.prototype.flatten=function(){for(var t=this,e=[],n=0;n<this.rootIds.length;n++){var r=this.rootIds[n];e.push({id:r,level:0,hasParent:!1,childrenCount:0}),u(r,this.nodes,e,0)}for(var i=0,s=e;i<s.length;i++){var o=s[i];o.childrenCount=a(o.id)}return e;function a(e){return t.nodes[e]?t.nodes[e].length:0}function u(t,e,n,r){if(void 0===r&&(r=0),t&&e&&n&&e[t]){r++;for(var i=e[t],s=0;s<i.length;s++){var o=i[s];n.push({id:o,level:r,hasParent:!0}),u(o,e,n,r)}r--}}},t.prototype.moveIdBeforeId=function(t,e){return this.moveId(t,e,r.BEFORE)},t.prototype.moveIdAfterId=function(t,e){return this.moveId(t,e,r.AFTER)},t.prototype.moveIdIntoId=function(t,e,n){return void 0===n&&(n=!0),n?this.moveId(t,e,r.INSIDE_AT_START):this.moveId(t,e,r.INSIDE_AT_END)},t.prototype.swapRootIdWithRootId=function(t,e){var n=this.findRootId(t),r=this.findRootId(e);this.swapRootPositionWithRootPosition(n,r)},t.prototype.swapRootPositionWithRootPosition=function(t,e){var n=this.rootIds[e];this.rootIds[e]=this.rootIds[t],this.rootIds[t]=n},t.prototype.deleteId=function(t){this.rootDeleteId(t),this.nodeAndSubNodesDelete(t),this.nodeRefrencesDelete(t)},t.prototype.insertIdBeforeId=function(t,e){var n=this.findRootId(t);for(var r in n>-1&&this.insertIdIntoRoot(e,n),this.nodes)if(this.nodes.hasOwnProperty(r)){var i=this.findNodeId(r,t);i>-1&&this.insertIdIntoNode(r,e,i)}},t.prototype.insertIdAfterId=function(t,e){var n=this.findRootId(t);for(var r in n>-1&&this.insertIdIntoRoot(e,n+1),this.nodes)if(this.nodes.hasOwnProperty(r)){var i=this.findNodeId(r,t);i>-1&&this.insertIdIntoNode(r,e,i+1)}},t.prototype.insertIdIntoId=function(t,e){this.nodeInsertAtEnd(t,e),this.nodes[e]=[]},t.prototype.insertIdIntoRoot=function(t,e){if(void 0===e)this.rootInsertAtEnd(t);else if(e<0){var n=this.rootIds.length;this.rootIds.splice(e+n+1,0,t)}else this.rootIds.splice(e,0,t);this.nodes[t]=this.nodes[t]||[]},t.prototype.insertIdIntoNode=function(t,e,n){if(this.nodes[t]=this.nodes[t]||[],this.nodes[e]=this.nodes[e]||[],void 0===n)this.nodeInsertAtEnd(t,e);else if(n<0){var r=this.nodes[t].length;this.nodes[t].splice(n+r+1,0,e)}else this.nodes[t].splice(n,0,e)},t.prototype.moveId=function(t,e,n){var i=t,s=this.findRootId(i);for(var o in this.nodes[e]&&e,this.nodes)if(this.nodes.hasOwnProperty(o)){this.findNodeId(o,e);break}var a=e,u=this.findRootId(a);for(var o in this.nodes[e]&&e,this.nodes)if(this.nodes.hasOwnProperty(o)){this.findNodeId(o,e);break}if(s>-1)if(u>-1)switch(this.rootDelete(s),u>s&&u--,n){case r.BEFORE:this.insertIdIntoRoot(i,u);break;case r.AFTER:this.insertIdIntoRoot(i,u+1);break;case r.INSIDE_AT_START:this.nodeInsertAtStart(a,i);break;case r.INSIDE_AT_END:this.nodeInsertAtEnd(a,i)}else for(var o in this.rootDelete(s),this.nodes){if(this.nodes.hasOwnProperty(o))if((h=this.findNodeId(o,a))>-1){switch(n){case r.BEFORE:this.insertIdIntoNode(o,i,h);break;case r.AFTER:this.insertIdIntoNode(o,i,h+1);break;case r.INSIDE_AT_START:this.nodeInsertAtStart(a,i);break;case r.INSIDE_AT_END:this.nodeInsertAtEnd(a,i)}break}}else if(u>-1){for(var o in this.nodes){if(this.nodes.hasOwnProperty(o))if((h=this.findNodeId(o,i))>-1){this.nodeDeleteAtIndex(o,h);break}}switch(n){case r.BEFORE:this.insertIdIntoRoot(i,u);break;case r.AFTER:this.insertIdIntoRoot(i,u+1);break;case r.INSIDE_AT_START:this.nodeInsertAtStart(a,i);break;case r.INSIDE_AT_END:this.nodeInsertAtEnd(a,i)}}else{for(var o in this.nodes){if(this.nodes.hasOwnProperty(o))if((h=this.findNodeId(o,i))>-1){this.nodeDeleteAtIndex(o,h);break}}for(var o in this.nodes){var h;if(this.nodes.hasOwnProperty(o))if((h=this.findNodeId(o,a))>-1){switch(n){case r.BEFORE:this.insertIdIntoNode(o,i,h);break;case r.AFTER:this.insertIdIntoNode(o,i,h+1);break;case r.INSIDE_AT_START:this.nodeInsertAtStart(a,i);break;case r.INSIDE_AT_END:this.nodeInsertAtEnd(a,i)}break}}}},t.prototype.swapArrayElements=function(t,e,n){var r=t[e];return t[e]=t[n],t[n]=r,t},t.prototype.rootDeleteId=function(t){var e=this.findRootId(t);e>-1&&this.rootDelete(e)},t.prototype.nodeAndSubNodesDelete=function(t){for(var e=[],n=0;n<this.nodes[t].length;n++){var r=this.nodes[t][n];this.nodeAndSubNodesDelete(r),e.push(t)}this.nodeDelete(t);for(n=0;n<e.length;n++)this.nodeDelete(e[n])},t.prototype.nodeRefrencesDelete=function(t){for(var e in this.nodes)if(this.nodes.hasOwnProperty(e))for(var n=0;n<this.nodes[e].length;n++){this.nodes[e][n]===t&&this.nodeDeleteAtIndex(e,n)}},t.prototype.nodeDelete=function(t){delete this.nodes[t]},t.prototype.findRootId=function(t){return this.rootIds.indexOf(t)},t.prototype.findNodeId=function(t,e){return this.nodes[t].indexOf(e)},t.prototype.findNode=function(t){return this.nodes[t]},t.prototype.nodeInsertAtStart=function(t,e){this.nodes[t].unshift(e)},t.prototype.nodeInsertAtEnd=function(t,e){this.nodes[t].push(e)},t.prototype.rootDelete=function(t){this.rootIds.splice(t,1)},t.prototype.nodeDeleteAtIndex=function(t,e){this.nodes[t].splice(e,1)},t.prototype.rootInsertAtStart=function(t){this.rootIds.unshift(t)},t.prototype.rootInsertAtEnd=function(t){this.rootIds.push(t)},t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(1),s=n(35);class o{static createDefault(t,e,n,r){if(r.Frequency-n.Frequency<=0)throw new Error("rangeLowest is not lower than rangeHighest!");return{name:t,midi:e,clef:i.ClefInstruction.getDefaultClefFromMidiInstrument(e),rangeLowest:n,rangeHighest:r}}}e.InstrumentOptions=o;class a extends o{static get(t){return a.init||this.buildMap(),this.defaults.get(t)}static buildMap(){const t=r.AccidentalEnum.NONE,e=new r.Pitch(r.NoteEnum.C,0,t),n=new r.Pitch(r.NoteEnum.C,3,t);this.defaults.set("piano",o.createDefault("piano",i.MidiInstrument.Electric_Grand_Piano,e,n)),this.defaults.set("trumpet",o.createDefault("trumpet",i.MidiInstrument.Trumpet,e,n))}}a.defaults=new Map,a.init=!1,e.DefaultInstrumentOptions=a;class u extends s.Distribution{}e.IntervalSettings=u;e.ComplexityMap=class{static getDurationSettings(t){return Array.from(h.ALL().values()).filter(e=>e.getComplexity()<=t).last()}static getPitchSettings(t){return Array.from(l.ALL().values()).filter(e=>e.getComplexity()<=t).last()}static getPitchIndex(t){const e=l.ALL(),n=Array.from(e.values()).filter(e=>e.getComplexity()<=t);return void 0!==n&&n.length>0?n.length-1:e.size-1}static getDurationIndex(t){const e=h.ALL(),n=Array.from(e.values()).filter(e=>e.getComplexity()<=t);return void 0!==n&&n.length>0?n.length-1:e.size-1}};class h extends s.Distribution{constructor(t,e){super(t,e)}static ALL(){const t=new Map;return t.set("MINIMAL",this.MINIMAL()),t.set("EASY",this.EASY()),t.set("TYPICAL",this.TYPICAL()),t.set("COMPLEX",this.COMPLEX()),t.set("CRAZY",this.CRAZY()),t}static MINIMAL(){return new h(.1,[new s.DistributionEntry(new r.Fraction(1,1),.1),new s.DistributionEntry(new r.Fraction(1,2),.3),new s.DistributionEntry(new r.Fraction(1,4),.6)])}static EASY(){return new h(.2,[new s.DistributionEntry(new r.Fraction(1,1),.1),new s.DistributionEntry(new r.Fraction(1,2),.3),new s.DistributionEntry(new r.Fraction(1,4),.4),new s.DistributionEntry(new r.Fraction(1,8),.2),new s.DistributionEntry(new r.Fraction(1,16),0)])}static TYPICAL(){return new h(.5,[new s.DistributionEntry(new r.Fraction(1,1),.05),new s.DistributionEntry(new r.Fraction(1,2),.3),new s.DistributionEntry(new r.Fraction(1,4),.4),new s.DistributionEntry(new r.Fraction(1,8),.2),new s.DistributionEntry(new r.Fraction(1,16),.05)])}static COMPLEX(){return new h(.7,[new s.DistributionEntry(new r.Fraction(1,1),.05),new s.DistributionEntry(new r.Fraction(1,2),.2),new s.DistributionEntry(new r.Fraction(1,4),.4),new s.DistributionEntry(new r.Fraction(1,8),.2),new s.DistributionEntry(new r.Fraction(1,16),.1),new s.DistributionEntry(new r.Fraction(1,16),.05)])}static CRAZY(){return new h(.9,[new s.DistributionEntry(new r.Fraction(1,1),.05),new s.DistributionEntry(new r.Fraction(1,2),.2),new s.DistributionEntry(new r.Fraction(1,4),.2),new s.DistributionEntry(new r.Fraction(1,8),.2),new s.DistributionEntry(new r.Fraction(1,16),.2),new s.DistributionEntry(new r.Fraction(1,16),.15)])}}e.DurationSettings=h;class l extends s.Distribution{constructor(t,e){super(t,e)}static ALL(){const t=new Map;return t.set("MINIMAL",this.MINIMAL()),t.set("EASY",this.EASY()),t.set("PENTATONIC",this.PENTATONIC()),t.set("HARMONIC",this.HARMONIC()),t.set("EQUIVALENT",this.EQUIVALENT()),t}static MINIMAL(){return new l(.1,[new s.DistributionEntry(0,2),new s.DistributionEntry(1,0),new s.DistributionEntry(2,0),new s.DistributionEntry(3,1),new s.DistributionEntry(4,1),new s.DistributionEntry(5,0),new s.DistributionEntry(6,0)])}static EASY(){return new l(.4,[new s.DistributionEntry(0,10),new s.DistributionEntry(1,3),new s.DistributionEntry(2,3),new s.DistributionEntry(3,7),new s.DistributionEntry(4,7),new s.DistributionEntry(5,2),new s.DistributionEntry(6,2)])}static PENTATONIC(){return new l(.3,[new s.DistributionEntry(0,1),new s.DistributionEntry(1,1),new s.DistributionEntry(2,0),new s.DistributionEntry(3,1),new s.DistributionEntry(4,1),new s.DistributionEntry(5,1),new s.DistributionEntry(6,0)])}static HARMONIC(){return new l(.6,[new s.DistributionEntry(0,10),new s.DistributionEntry(1,5),new s.DistributionEntry(2,6),new s.DistributionEntry(3,10),new s.DistributionEntry(4,8),new s.DistributionEntry(5,7),new s.DistributionEntry(6,2)])}static EQUIVALENT(){return new l(.8,[new s.DistributionEntry(0,1),new s.DistributionEntry(1,1),new s.DistributionEntry(2,1),new s.DistributionEntry(3,1),new s.DistributionEntry(4,1),new s.DistributionEntry(5,1),new s.DistributionEntry(6,1)])}}e.PitchSettings=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(25);e.GeneratorPluginFactory=class{static build(t,e){switch(t){case r.ExampleSourceGenerator.NAME:return new r.ExampleSourceGenerator(e);default:throw new Error("Plugin subtype not given")}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(28);e.StateManager=class{constructor(){this.noteEvents=[],this.noteFrequency=new i.Dictionary,this.localNoteEvents=[],this.localNoteFrequency=new i.Dictionary}updateGlobaleState(t){for(const e of t)this.noteEvents.push(e),this.updateEventsList(this.noteEvents,e),this.updateFrequencyMap(this.noteFrequency,e)}setLocalState(t){if(void 0===t||t===[])this.localNoteFrequency=new i.Dictionary,this.localNoteEvents=[];else{this.localNoteFrequency=new i.Dictionary,this.localNoteEvents=t;for(const e of t)this.updateFrequencyMap(this.localNoteFrequency,e)}}adaptLocalState(t){this.updateEventsList(this.localNoteEvents,t),this.updateFrequencyMap(this.localNoteFrequency,t)}printStatistics(){let t="noteFrequency: ";this.noteFrequency.forEach((e,n)=>{t+=e+": "+n+"; "}),console.log(t),console.log("local state:");let e="localNoteFrequency: ";this.localNoteFrequency.forEach((t,n)=>{e+=t+": "+n+"; "}),console.log(e)}updateEventsList(t,e){t.push(e)}updateFrequencyMap(t,e){const n=this.getNoteKey(e);if(t.containsKey(n)){const e=t.getValue(n)+1;t.setValue(n,e)}else t.setValue(n,1)}getNoteKey(t){const e=t.Pitch.getHalfTone(),n=t.Pitch.Octave,i=e+r.Pitch.HalfTonesFromAccidental(t.Pitch.Accidental),s=t.Pitch.FundamentalNote;return r.Pitch.getNoteEnumString(s)+n+"-"+i+"-"+t.Pitch.Accidental}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.MusicalEntry=class{},function(t){t[t.S0_UNISON=0]="S0_UNISON",t[t.S1_SECOND_MINOR=1]="S1_SECOND_MINOR",t[t.S2_SECOND_MAJOR=2]="S2_SECOND_MAJOR",t[t.S3_THIRD_MINOR=3]="S3_THIRD_MINOR",t[t.S4_THIRD_MAJOR=4]="S4_THIRD_MAJOR",t[t.S5_FOURTH_PERFECT=5]="S5_FOURTH_PERFECT",t[t.S6_FOURTH_MINOR=6]="S6_FOURTH_MINOR",t[t.S7_FIFTH_PERFECT=7]="S7_FIFTH_PERFECT",t[t.S8_SIXTH_MINOR=8]="S8_SIXTH_MINOR",t[t.S9_SIXTH_MAJOR=9]="S9_SIXTH_MAJOR",t[t.S10_SEVENTH_MINOR=10]="S10_SEVENTH_MINOR",t[t.S11_SEVENTH_MAJOR=11]="S11_SEVENTH_MAJOR",t[t.S12_OCTAVE=12]="S12_OCTAVE"}(e.MusicalIntervalType||(e.MusicalIntervalType={}));e.NextFuture=class{}},function(t,e,n){(function(){var e,r,i,s,o,a,u,h,l;({assign:h,isFunction:l}=n(4)),i=n(38),s=n(39),o=n(64),u=n(24),a=n(65),e=n(0),r=n(9),t.exports.create=function(t,e,n,r){var i,o;if(null==t)throw new Error("Root element needs a name.");return r=h({},e,n,r),o=(i=new s(r)).element(t),r.headless||(i.declaration(r),null==r.pubID&&null==r.sysID||i.dtd(r)),o},t.exports.begin=function(t,e,n){return l(t)&&([e,n]=[t,e],t={}),e?new o(t,e,n):new s(t)},t.exports.stringWriter=function(t){return new u(t)},t.exports.streamWriter=function(t,e){return new a(t,e)},t.exports.implementation=new i,t.exports.nodeType=e,t.exports.writerState=r}).call(this)},function(t,e,n){(function(){var e,r;e=n(60),r=n(61),t.exports=function(){class t{constructor(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}getParameter(t){return this.params.hasOwnProperty(t)?this.params[t]:null}canSetParameter(t,e){return!0}setParameter(t,e){return null!=e?this.params[t]=e:delete this.params[t]}}return Object.defineProperty(t.prototype,"parameterNames",{get:function(){return new r(Object.keys(this.defaultParams))}}),t}.call(this)}).call(this)},function(t,e){(function(){t.exports=class{constructor(){}handleError(t){throw new Error(t)}}}).call(this)},function(t,e){(function(){t.exports=function(){class t{constructor(t){this.arr=t||[]}item(t){return this.arr[t]||null}contains(t){return-1!==this.arr.indexOf(t)}}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t}.call(this)}).call(this)},function(t,e){(function(){t.exports=function(){class t{constructor(t){this.nodes=t}clone(){return this.nodes=null}item(t){return this.nodes[t]||null}}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t}.call(this)}).call(this)},function(t,e){(function(){t.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},function(t,e,n){(function(){var e,r,i,s,o,a,u,h,l,c,d,p,f,m,y,g,w,v,E,b,I,D,N={}.hasOwnProperty;({isObject:I,isFunction:b,isPlainObject:D,getValue:E}=n(4)),e=n(0),p=n(39),f=n(11),s=n(13),o=n(14),y=n(21),v=n(22),m=n(23),c=n(15),d=n(16),a=n(17),h=n(18),u=n(19),l=n(20),i=n(40),w=n(42),g=n(24),r=n(9),t.exports=class{constructor(t,n,r){var i;this.name="?xml",this.type=e.Document,t||(t={}),i={},t.writer?D(t.writer)&&(i=t.writer,t.writer=new g):t.writer=new g,this.options=t,this.writer=t.writer,this.writerOptions=this.writer.filterOptions(i),this.stringify=new w(t),this.onDataCallback=n||function(){},this.onEndCallback=r||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}createChildNode(t){var n,r,i,s,o,a,u,h;switch(t.type){case e.CData:this.cdata(t.value);break;case e.Comment:this.comment(t.value);break;case e.Element:for(r in i={},u=t.attribs)N.call(u,r)&&(n=u[r],i[r]=n.value);this.node(t.name,i);break;case e.Dummy:this.dummy();break;case e.Raw:this.raw(t.value);break;case e.Text:this.text(t.value);break;case e.ProcessingInstruction:this.instruction(t.target,t.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+t.constructor.name)}for(o=0,a=(h=t.children).length;o<a;o++)s=h[o],this.createChildNode(s),s.type===e.Element&&this.up();return this}dummy(){return this}node(t,e,n){if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=E(t),null==e&&(e={}),e=E(e),I(e)||([n,e]=[e,n]),this.currentNode=new f(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=n&&this.text(n),this}element(t,n,r){var i,s,o,a,u,h;if(this.currentNode&&this.currentNode.type===e.DocType)this.dtdElement(...arguments);else if(Array.isArray(t)||I(t)||b(t))for(a=this.options.noValidation,this.options.noValidation=!0,(h=new p(this.options).element("TEMP_ROOT")).element(t),this.options.noValidation=a,s=0,o=(u=h.children).length;s<o;s++)i=u[s],this.createChildNode(i),i.type===e.Element&&this.up();else this.node(t,n,r);return this}attribute(t,e){var n,r;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=E(t)),I(t))for(n in t)N.call(t,n)&&(r=t[n],this.attribute(n,r));else b(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new i(this,t,""):null!=e&&(this.currentNode.attribs[t]=new i(this,t,e));return this}text(t){var e;return this.openCurrent(),e=new v(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}cdata(t){var e;return this.openCurrent(),e=new s(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}comment(t){var e;return this.openCurrent(),e=new o(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}raw(t){var e;return this.openCurrent(),e=new y(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}instruction(t,e){var n,r,i,s,o;if(this.openCurrent(),null!=t&&(t=E(t)),null!=e&&(e=E(e)),Array.isArray(t))for(n=0,s=t.length;n<s;n++)r=t[n],this.instruction(r);else if(I(t))for(r in t)N.call(t,r)&&(i=t[r],this.instruction(r,i));else b(e)&&(e=e.apply()),o=new m(this,t,e),this.onData(this.writer.processingInstruction(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}declaration(t,e,n){var r;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return r=new c(this,t,e,n),this.onData(this.writer.declaration(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}doctype(t,e,n){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new d(this,e,n),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this}dtdElement(t,e){var n;return this.openCurrent(),n=new u(this,t,e),this.onData(this.writer.dtdElement(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}attList(t,e,n,r,i){var s;return this.openCurrent(),s=new a(this,t,e,n,r,i),this.onData(this.writer.dtdAttList(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}entity(t,e){var n;return this.openCurrent(),n=new h(this,!1,t,e),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}pEntity(t,e){var n;return this.openCurrent(),n=new h(this,!0,t,e),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}notation(t,e){var n;return this.openCurrent(),n=new l(this,t,e),this.onData(this.writer.dtdNotation(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}up(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this}end(){for(;this.currentLevel>=0;)this.up();return this.onEnd()}openCurrent(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)}openNode(t){var n,i,s,o;if(!t.isOpen){if(this.root||0!==this.currentLevel||t.type!==e.Element||(this.root=t),i="",t.type===e.Element){for(s in this.writerOptions.state=r.OpenTag,i=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<"+t.name,o=t.attribs)N.call(o,s)&&(n=o[s],i+=this.writer.attribute(n,this.writerOptions,this.currentLevel));i+=(t.children?">":"/>")+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=r.InsideTag}else this.writerOptions.state=r.OpenTag,i=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?i+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(i+=' SYSTEM "'+t.sysID+'"'),t.children?(i+=" [",this.writerOptions.state=r.InsideTag):(this.writerOptions.state=r.CloseTag,i+=">"),i+=this.writer.endline(t,this.writerOptions,this.currentLevel);return this.onData(i,this.currentLevel),t.isOpen=!0}}closeNode(t){var n;if(!t.isClosed)return n="",this.writerOptions.state=r.CloseTag,n=t.type===e.Element?this.writer.indent(t,this.writerOptions,this.currentLevel)+"</"+t.name+">"+this.writer.endline(t,this.writerOptions,this.currentLevel):this.writer.indent(t,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=r.None,this.onData(n,this.currentLevel),t.isClosed=!0}onData(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)}onEnd(){return this.documentCompleted=!0,this.onEndCallback()}debugInfo(t){return null==t?"":"node: <"+t+">"}ele(){return this.element(...arguments)}nod(t,e,n){return this.node(t,e,n)}txt(t){return this.text(t)}dat(t){return this.cdata(t)}com(t){return this.comment(t)}ins(t,e){return this.instruction(t,e)}dec(t,e,n){return this.declaration(t,e,n)}dtd(t,e,n){return this.doctype(t,e,n)}e(t,e,n){return this.element(t,e,n)}n(t,e,n){return this.node(t,e,n)}t(t){return this.text(t)}d(t){return this.cdata(t)}c(t){return this.comment(t)}r(t){return this.raw(t)}i(t,e){return this.instruction(t,e)}att(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList(...arguments):this.attribute(...arguments)}a(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList(...arguments):this.attribute(...arguments)}ent(t,e){return this.entity(t,e)}pent(t,e){return this.pEntity(t,e)}not(t,e){return this.notation(t,e)}}}).call(this)},function(t,e,n){(function(){var e,r,i,s={}.hasOwnProperty;e=n(0),i=n(43),r=n(9),t.exports=class extends i{constructor(t,e){super(e),this.stream=t}endline(t,e,n){return t.isLastRootNode&&e.state===r.CloseTag?"":super.endline(t,e,n)}document(t,e){var n,r,i,s,o,a,u,h,l;for(r=i=0,o=(u=t.children).length;i<o;r=++i)(n=u[r]).isLastRootNode=r===t.children.length-1;for(e=this.filterOptions(e),l=[],s=0,a=(h=t.children).length;s<a;s++)n=h[s],l.push(this.writeChildNode(n,e,0));return l}cdata(t,e,n){return this.stream.write(super.cdata(t,e,n))}comment(t,e,n){return this.stream.write(super.comment(t,e,n))}declaration(t,e,n){return this.stream.write(super.declaration(t,e,n))}docType(t,e,n){var i,s,o,a;if(n||(n=0),this.openNode(t,e,n),e.state=r.OpenTag,this.stream.write(this.indent(t,e,n)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,e,n)),e.state=r.InsideTag,s=0,o=(a=t.children).length;s<o;s++)i=a[s],this.writeChildNode(i,e,n+1);e.state=r.CloseTag,this.stream.write("]")}return e.state=r.CloseTag,this.stream.write(e.spaceBeforeSlash+">"),this.stream.write(this.endline(t,e,n)),e.state=r.None,this.closeNode(t,e,n)}element(t,n,i){var o,a,u,h,l,c,d,p,f,m,y,g,w,v;if(i||(i=0),this.openNode(t,n,i),n.state=r.OpenTag,f=this.indent(t,n,i)+"<"+t.name,n.pretty&&n.width>0)for(p in c=f.length,y=t.attribs)s.call(y,p)&&(o=y[p],c+(m=this.attribute(o,n,i)).length>n.width?(v=this.indent(t,n,i+1)+m,f+=this.endline(t,n,i)+v,c=v.length):(f+=v=" "+m,c+=v.length));else for(p in g=t.attribs)s.call(g,p)&&(o=g[p],f+=this.attribute(o,n,i));if(this.stream.write(f),h=0===(u=t.children.length)?null:t.children[0],0===u||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))n.allowEmpty?(this.stream.write(">"),n.state=r.CloseTag,this.stream.write("</"+t.name+">")):(n.state=r.CloseTag,this.stream.write(n.spaceBeforeSlash+"/>"));else if(!n.pretty||1!==u||h.type!==e.Text&&h.type!==e.Raw||null==h.value){for(this.stream.write(">"+this.endline(t,n,i)),n.state=r.InsideTag,l=0,d=(w=t.children).length;l<d;l++)a=w[l],this.writeChildNode(a,n,i+1);n.state=r.CloseTag,this.stream.write(this.indent(t,n,i)+"</"+t.name+">")}else this.stream.write(">"),n.state=r.InsideTag,n.suppressPrettyCount++,!0,this.writeChildNode(h,n,i+1),n.suppressPrettyCount--,!1,n.state=r.CloseTag,this.stream.write("</"+t.name+">");return this.stream.write(this.endline(t,n,i)),n.state=r.None,this.closeNode(t,n,i)}processingInstruction(t,e,n){return this.stream.write(super.processingInstruction(t,e,n))}raw(t,e,n){return this.stream.write(super.raw(t,e,n))}text(t,e,n){return this.stream.write(super.text(t,e,n))}dtdAttList(t,e,n){return this.stream.write(super.dtdAttList(t,e,n))}dtdElement(t,e,n){return this.stream.write(super.dtdElement(t,e,n))}dtdEntity(t,e,n){return this.stream.write(super.dtdEntity(t,e,n))}dtdNotation(t,e,n){return this.stream.write(super.dtdNotation(t,e,n))}}}).call(this)},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(46)),r(n(27)),r(n(34)),r(n(69))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.WHOLE=0]="WHOLE",t[t.HALF=1]="HALF",t[t.QUARTER=2]="QUARTER",t[t.EIGHTH=3]="EIGHTH",t[t.SIXTEENTH=4]="SIXTEENTH"}(e.Duration||(e.Duration={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(44),s=n(1);class o{constructor(t,e,n,r){this.symbol=t,this.halftone=e,this.accidental=n,this.noteEnum=r}static getAllTones(){return void 0===this.allTones&&(this.allTones=new Array,this.allTones.push(o.Cb),this.allTones.push(o.C),this.allTones.push(o.Cs),this.allTones.push(o.Db),this.allTones.push(o.D),this.allTones.push(o.Ds),this.allTones.push(o.Eb),this.allTones.push(o.E),this.allTones.push(o.Es),this.allTones.push(o.Fb),this.allTones.push(o.F),this.allTones.push(o.Fs),this.allTones.push(o.Gb),this.allTones.push(o.G),this.allTones.push(o.Gs),this.allTones.push(o.Ab),this.allTones.push(o.A),this.allTones.push(o.As),this.allTones.push(o.Bb),this.allTones.push(o.B),this.allTones.push(o.Bs)),this.allTones}static getToneFromSymbol(t,e){return this.getAllTones().filter(e=>e.symbol===t).filter(t=>t.accidental===e)[0]}static getToneFromSymbolHalftone(t,e){return this.getAllTones().filter(e=>e.symbol===t).filter(t=>t.halftone===e)[0]}getSymbol(){return this.symbol}getHalftone(){return this.halftone}getAccidental(){return this.accidental}getNoteEnum(){return this.noteEnum}toPitch(t){const e=r.Pitch.AccidentalFromHalfTones(this.accidental);return new r.Pitch(this.noteEnum,t,e)}}o.Cb=new o(0,11,-1,r.NoteEnum.C),o.C=new o(0,0,0,r.NoteEnum.C),o.Cs=new o(0,1,1,r.NoteEnum.C),o.Db=new o(1,1,-1,r.NoteEnum.D),o.D=new o(1,2,0,r.NoteEnum.D),o.Ds=new o(1,3,1,r.NoteEnum.D),o.Eb=new o(2,3,-1,r.NoteEnum.E),o.E=new o(2,4,0,r.NoteEnum.E),o.Es=new o(2,5,1,r.NoteEnum.E),o.Fb=new o(3,4,-1,r.NoteEnum.F),o.F=new o(3,5,0,r.NoteEnum.F),o.Fs=new o(3,6,1,r.NoteEnum.F),o.Gb=new o(4,6,-1,r.NoteEnum.G),o.G=new o(4,7,0,r.NoteEnum.G),o.Gs=new o(4,8,1,r.NoteEnum.G),o.Ab=new o(5,8,-1,r.NoteEnum.A),o.A=new o(5,9,0,r.NoteEnum.A),o.As=new o(5,10,1,r.NoteEnum.A),o.Bb=new o(6,10,-1,r.NoteEnum.B),o.B=new o(6,11,0,r.NoteEnum.B),o.Bs=new o(6,0,1,r.NoteEnum.B),o.allTones=void 0,e.Tone=o;class a{}a.MAJOR=[0,2,2,1,2,2,2,1],a.MINOR_NATURAL=[0,2,1,2,2,1,2,2],a.MINOR_HARMONIC=[0,2,1,2,2,1,3,1],a.MINOR_MELODIC=[0,2,1,2,2,2,2,1],e.ScaleKeyPatterns=a;class u{constructor(t,e){this.tone=t,this.type=e,this.init()}static create(t,e){return new u(e,t)}static fromStringCode(t){const e=t.split("_"),n=e[0].toLowerCase(),r=e[1];let s=void 0;switch(n){case"major":s=i.ScaleType.MAJOR;break;default:s=i.ScaleType.MAJOR}let a=0,h=0;if(r.indexOf("-")>-1){const t=r.split("-");a=parseInt(t[0],10),"b"===t[1]?h=-1:"#"===t[1]&&(h=1)}const l=o.getToneFromSymbol(a,h);return u.create(s,l)}init(){let t=void 0;switch(this.type){case i.ScaleType.MAJOR:t=a.MAJOR;break;case i.ScaleType.MINOR_NATURAL:t=a.MINOR_NATURAL;break;case i.ScaleType.MINOR_HARMONIC:t=a.MINOR_HARMONIC;break;case i.ScaleType.MINOR_MELODIC:t=a.MINOR_MELODIC;break;default:throw Error("Could not choose a ScaleKeyPatterns pattern for ScaleType "+this.type)}this.tones=u.buildTones(this.tone,t)}getTones(){return this.tones}getKeyNumber(){let t=0;return this.getTones().forEach(e=>{t+=e.getAccidental()}),t}getKeyMode(){switch(this.type){case i.ScaleType.MAJOR:return s.KeyEnum.major;case i.ScaleType.MINOR_HARMONIC:case i.ScaleType.MINOR_MELODIC:case i.ScaleType.MINOR_NATURAL:return s.KeyEnum.minor;default:return s.KeyEnum.none}}static buildTones(t,e){const n=new Array(e.length-1),r=t.getSymbol();let i=t.getHalftone(),s=r;for(let t=0;t<e.length-1;t++){const r=e[t];i=(i+r)%12;const a=o.getAllTones().filter(t=>t.getSymbol()===s);if(a.length>0){const e=a.filter(t=>t.getHalftone()===i);if(e.length>0){const r=e[0];n[t]=r}}else console.log("No candidates found!");s=(s+1)%7}return n}}e.ScaleKey=u},function(t,e,n){"use strict";function r(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r(n(37)),r(n(36)),r(n(45))}])}));
//# sourceMappingURL=osme.min.js.map